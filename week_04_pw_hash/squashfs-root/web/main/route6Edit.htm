<script language="javascript" type="text/javascript">var opt=$.mainParam[0];var stk=$.mainParam[1];var ipConnList;var pppConnList;var staticRteList;function isValidGLUIP6AddrStrict(ip6Addr){var flag;var regExp=/^(:|[a-f]|[A-F]|[0-9]){1,39}$/;if(regExp.test(ip6Addr)){flag=true}else{flag=false}regExp=/::/;if(flag){if(regExp.test(ip6Addr)){regExp=/^([a-f]|[A-F]|[0-9])*(::)([a-f]|[A-F]|[0-9])*(::)([a-f]|[A-F]|[0-9])*$/;if(regExp.test(ip6Addr)){flag=false}else{var index=ip6Addr.indexOf("::");var len=ip6Addr.length;var substr1=ip6Addr.substr(0,index);var substr2=ip6Addr.substr(index+2,len-index-2);regExp=/^(([a-f]|[A-F]|[0-9]){1,4}(:)){0,6}([a-f]|[A-F]|[0-9]){1,4}$/;var num=0;if(""==substr1&&""==substr2){flag=false}else{if(""==substr2){flag=false}else{if(""==substr1){if(!regExp.test(substr2)){flag=false}}else{if(!regExp.test(substr1)||!regExp.test(substr2)){flag=false}else{if(regExp.test(substr1)&&regExp.test(substr2)){for(var i=0;i<substr1.length;i++){if(substr1.charAt(i)==":"){num+=1}}for(var i=0;i<substr2.length;i++){if(substr1.charAt(i)==":"){num+=1}}if(num>5){flag=false}}}}}}}}else{regExp=/^(([a-f]|[A-F]|[0-9]){1,4}(:)){7}([a-f]|[A-F]|[0-9]){1,4}$/;if(!regExp.test(ip6Addr)){flag=false}}}if(flag){var index;index=ip6Addr.indexOf(":");var substr=ip6Addr.substr(0,index);if(0==index||parseInt(substr,16)==0){regExp=/^((0{0,4})|::|:)*$/;if(regExp.test(ip6Addr)){flag=false}regExp=/^(((0){0,4})|::|:)*((0){0,3}(1))$/;if(regExp.test(ip6Addr)){flag=false}}else{if(parseInt(substr,16)>=65280){flag=false}else{if(parseInt(substr,16)>=65152&&parseInt(substr,16)<=65215){flag=true}else{if(parseInt(substr,16)>=8192&&parseInt(substr,16)<=16383){flag=true}}}}}return flag}function isValidGLUIP6Addr(ip6Addr){var flag;var regExp=/^(:|[a-f]|[A-F]|[0-9]){1,39}$/;if(regExp.test(ip6Addr)){flag=true}else{flag=false}regExp=/::/;if(flag){if(regExp.test(ip6Addr)){regExp=/^([a-f]|[A-F]|[0-9])*(::)([a-f]|[A-F]|[0-9])*(::)([a-f]|[A-F]|[0-9])*$/;if(regExp.test(ip6Addr)){flag=false}else{var index=ip6Addr.indexOf("::");var len=ip6Addr.length;var substr1=ip6Addr.substr(0,index);var substr2=ip6Addr.substr(index+2,len-index-2);regExp=/^(([a-f]|[A-F]|[0-9]){1,4}(:)){0,6}([a-f]|[A-F]|[0-9]){1,4}$/;var num=0;if(""==substr1&&""==substr2){return true}else{if(""==substr2){if(!regExp.test(substr1)){flag=false}}else{if(""==substr1){if(!regExp.test(substr2)){flag=false}}else{if(!regExp.test(substr1)||!regExp.test(substr2)){flag=false}else{if(regExp.test(substr1)&&regExp.test(substr2)){for(var i=0;i<substr1.length;i++){if(substr1.charAt(i)==":"){num+=1}}for(var i=0;i<substr2.length;i++){if(substr1.charAt(i)==":"){num+=1}}if(num>5){flag=false}}}}}}}}else{regExp=/^(([a-f]|[A-F]|[0-9]){1,4}(:)){7}([a-f]|[A-F]|[0-9]){1,4}$/;if(!regExp.test(ip6Addr)){flag=false}}}if(flag){var index;index=ip6Addr.indexOf(":");var substr=ip6Addr.substr(0,index);if(0==index||parseInt(substr,16)==0){regExp=/^((0{0,4})|::|:)*$/;if(regExp.test(ip6Addr)){flag=false}regExp=/^(((0){0,4})|::|:)*((0){0,3}(1))$/;if(regExp.test(ip6Addr)){flag=false}}else{if(parseInt(substr,16)>=65280){flag=false}else{if(parseInt(substr,16)>=65152&&parseInt(substr,16)<=65215){flag=true}else{if(parseInt(substr,16)>=8192&&parseInt(substr,16)<=16383){flag=true}}}}}return flag}function init(){if(opt==1){var staticRteCfg=$.act(ACT_GET,L3_IP6_FORWARDING_ENTRY,stk,null,["destIPv6Address","destIPv6AddressPrefixLength","gatewayIPv6Address","__ifAliasName","interface","enable"])}ipConnList=$.act(ACT_GL,WAN_IP_CONN,null,null,["name","enable","X_TP_IfName","X_TP_IPv6Enabled"]);pppConnList=$.act(ACT_GL,WAN_PPP_CONN,null,null,["name","enable","X_TP_IfName","X_TP_IPv6Enabled"]);var sel=$.id("wanInf");if(!$.exe()){for(var i=0;i<ipConnList.length;i++){if(ipConnList[i].enable==1&&ipConnList[i].X_TP_IPv6Enabled==1){var option=$.c("option");option.value=ipConnList[i].name;option.text=ipConnList[i].name;try{sel.add(option,null)}catch(e){sel.add(option)}}}for(var i=0;i<pppConnList.length;i++){if(pppConnList[i].enable==1&&pppConnList[i].X_TP_IPv6Enabled==1){var option=$.c("option");option.value=pppConnList[i].name;option.text=pppConnList[i].name;try{sel.add(option,null)}catch(e){sel.add(option)}}}var option=$.c("option");option.value="LAN";option.text="LAN";try{sel.add(option,null)}catch(e){sel.add(option)}if(opt==1){$.id("desAddr").value=staticRteCfg.destIPv6Address;$.id("prelen").value=staticRteCfg.destIPv6AddressPrefixLength;$.id("defGw").value=staticRteCfg.gatewayIPv6Address;$.id("wanInf").value=staticRteCfg.__ifAliasName;$.id("state").value=staticRteCfg.enable}}}function doSave(){var regExp=/^[0-9]{1,2}$/;if(!isValidGLUIP6Addr($.id("desAddr").value)){$.alert(ERR_ROUTE6_DST_ADDR_VALID);var element=$.id("desAddr");if(element){element.focus();element.select()}return false}if((!regExp.test($.id("prelen").value))||$.id("prelen").value>64||($.id("prelen").value%8)!=0){$.alert(ERR_ROUTE6_PREFIX_LEN_VALID);var element=$.id("prelen");if(element){element.focus();element.select()}return false}if(!isValidGLUIP6AddrStrict($.id("defGw").value)){$.alert(ERR_ROUTE6_GW_ADDR_VALID);var element=$.id("defGw");if(element){element.focus();element.select()}return false}var staticRteAttrs={};staticRteAttrs.destIPv6Address=$.id("desAddr").value;staticRteAttrs.destIPv6AddressPrefixLength=$.id("prelen").value;staticRteAttrs.gatewayIPv6Address=$.id("defGw").value;staticRteAttrs.__ifAliasName=$.id("wanInf").value;staticRteAttrs.enable=$.id("state").value;if($.id("wanInf").value=="LAN"){staticRteAttrs["interface"]="br0"}else{for(var i=0;i<ipConnList.length;i++){if(ipConnList[i].enable==1&&ipConnList[i].X_TP_IPv6Enabled==1&&ipConnList[i].name==staticRteAttrs.__ifAliasName){staticRteAttrs["interface"]=ipConnList[i].X_TP_IfName}}for(var i=0;i<pppConnList.length;i++){if(pppConnList[i].enable==1&&pppConnList[i].X_TP_IPv6Enabled==1&&pppConnList[i].name==staticRteAttrs.__ifAliasName){staticRteAttrs["interface"]=pppConnList[i].X_TP_IfName}}}if(opt==0){$.act(ACT_ADD,L3_IP6_FORWARDING_ENTRY,null,null,staticRteAttrs)}else{if(opt==1){$.act(ACT_SET,L3_IP6_FORWARDING_ENTRY,stk,null,staticRteAttrs)}}$.addLoading($.id("saveBtn"));$.exe(function(err){if(!err){$.loadMain("route6.htm")}})};</script>
<p class="et T" id="et">IPv6 Static Route</p>
<div class="con1 L">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="L1 T" id="t_info">IPv6 Static Route information can be set on this page.</p>
<p class="L1 T" id="t_note">Note: Only support IPv6 address which prefix length is 8/16/24/32/40/48/56/64.</p>
<p class="br"></p>
<p class="L1"><b class="item M T" id="t_dstip6">Destination IPv6 Address:</b><input type="text" class="text" id="desAddr" size="17"  maxlength="39" /></p>
<p class="L1"><b class="item M T" id="t_plen">Prefix Length:</b><input type="text" class="text" id="prelen" size="17"  maxlength="39" /></p>
<p class="L1"><b class="item M T T_gateway">Gateway:</b><input type="text" class="text" id="defGw" size="17"  maxlength="39" /></p>
<p class="L1"><b class="item M T T_intf">Interface:</b><select class="L" id="wanInf"></select></p>
<p class="L1"><b class="item M T T_status">Status:</b><select class="L" id="state">
			<option value="1" class="T T_enabled" id="state_en">Enabled</option>
			<option value="0" class="T T_disabled" id="state_dis">Disabled</option>
</select></p>
</div>
<p class="bl"></p>
<p class="tail">
<input type="button" class="button L T T_save" id="saveBtn" value="Save" onclick="doSave();" />
<input type="button" class="button L T T_back" value="Back" onclick="$.loadMain('route6.htm')"/>
</p>
</div>
<script language="javascript" type="text/javascript">init();</script>
