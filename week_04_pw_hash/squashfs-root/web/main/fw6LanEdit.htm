<script language="javascript" type="text/javascript">var opt=$.mainParam[0];var returnPage=$.mainParam[1];var stk=$.mainParam[2];function doReturn(){if(returnPage==1){var param=[];if($.mainParam[2]!=undefined&&$.mainParam[2]!=-1){param[0]=1;param[1]=$.mainParam[2]}else{param[0]=0;param[1]=-1}$.loadMain("fw6RulesEdit.htm",param)}else{if(returnPage==2){$.loadMain("fw6Rules.htm")}else{$.loadMain("fw6Lan.htm")}}}function isValidPreLen(ip6PreLen){var regExp=/^[0-9]{1,3}$/;if((!regExp.test(ip6PreLen))||ip6PreLen<0||ip6PreLen>128||(ip6PreLen%8)!=0){return false}return true}function isValidGLUIP6Addr(ip6Addr){var flag;var regExp=/^(:|[a-f]|[A-F]|[0-9]){1,39}$/;if(regExp.test(ip6Addr)){flag=true}else{flag=false}regExp=/::/;if(flag){if(regExp.test(ip6Addr)){regExp=/^([a-f]|[A-F]|[0-9])*(::)([a-f]|[A-F]|[0-9])*(::)([a-f]|[A-F]|[0-9])*$/;if(regExp.test(ip6Addr)){flag=false}else{var index=ip6Addr.indexOf("::");var len=ip6Addr.length;var substr1=ip6Addr.substr(0,index);var substr2=ip6Addr.substr(index+2,len-index-2);regExp=/^(([a-f]|[A-F]|[0-9]){1,4}(:)){0,6}([a-f]|[A-F]|[0-9]){1,4}$/;var num=0;if(""==substr1&&""==substr2){return true}else{if(""==substr2){if(!regExp.test(substr1)){flag=false}}else{if(""==substr1){if(!regExp.test(substr2)){flag=false}}else{if(!regExp.test(substr1)||!regExp.test(substr2)){flag=false}else{if(regExp.test(substr1)&&regExp.test(substr2)){for(var i=0;i<substr1.length;i++){if(substr1.charAt(i)==":"){num+=1}}for(var i=0;i<substr2.length;i++){if(substr2.charAt(i)==":"){num+=1}}if(num>5){flag=false}}}}}}}}else{regExp=/^(([a-f]|[A-F]|[0-9]){1,4}(:)){7}([a-f]|[A-F]|[0-9]){1,4}$/;if(!regExp.test(ip6Addr)){flag=false}}}if(flag){var index;index=ip6Addr.indexOf(":");var substr=ip6Addr.substr(0,index);if(0==index||parseInt(substr,16)==0){regExp=/^((0{0,4})|::|:)*$/;if(regExp.test(ip6Addr)){flag=false}regExp=/^(((0){0,4})|::|:)*((0){0,3}(1))$/;if(regExp.test(ip6Addr)){flag=false}}else{if(parseInt(substr,16)>=65280){flag=false}else{if(parseInt(substr,16)>=65152&&parseInt(substr,16)<=65215){flag=true}else{if(parseInt(substr,16)>=8192&&parseInt(substr,16)<=16383){flag=true}}}}}return flag}function init(){if(opt==1){var fwCfg=$.act(ACT_GET,IP6_INTERNAL_HOST,stk,null);$.exe(function(err){if(!err){if(fwCfg.type==0){$.id("entryName").value=fwCfg.entryName;$.id("ipaddr").value=fwCfg.IPv6Address;$.id("prelen").value=(fwCfg.IPv6PrefixLength!=0)?fwCfg.IPv6PrefixLength:"";if(fwCfg.portStart==fwCfg.portEnd){$.id("portStart").value=(fwCfg.portStart!=0)?fwCfg.portStart:"";$.id("portEnd").value=""}else{$.id("portStart").value=(fwCfg.portStart!=0)?fwCfg.portStart:"";$.id("portEnd").value=(fwCfg.portEnd!=0)?fwCfg.portEnd:""}}}})}}function doSave(){var fwAttrs={};if(!$.isname($.id("entryName").value)){$.alert(ERR_FW_ENTRYNAME_INVAD);var element=$.id("entryName");if(element){element.focus();element.select()}return false}if(($.id("ipaddr").value!="")&&(false==isValidGLUIP6Addr($.id("ipaddr").value))){$.alert(ERR_FW6_ADDR_INVAD);var element=$.id("ipaddr");if(element){element.focus();element.select()}return false}if(($.id("prelen").value!="")&&(false==isValidPreLen($.id("prelen").value))){$.alert(ERR_FW6_PFXLEN_INVAD);var element=$.id("prelen");if(element){element.focus();element.select()}return false}if(($.id("portStart").value!="")&&(!$.isnum($.id("portStart").value))||(parseInt($.id("portStart").value,10)<1)||(parseInt($.id("portStart").value,10)>65535)){$.alert(ERR_PORT_NUM_INVAD);var element=$.id("portStart");if(element){element.focus();element.select()}return false}if(($.id("portEnd").value!="")&&(!$.isnum($.id("portEnd").value))||(parseInt($.id("portEnd").value,10)<1)||(parseInt($.id("portEnd").value,10)>65535)){$.alert(ERR_PORT_NUM_INVAD);var element=$.id("portEnd");if(element){element.focus();element.select()}return false}if(($.id("portStart").value!="")&&($.id("portEnd").value!="")&&(parseInt($.id("portEnd").value,10)<parseInt($.id("portStart").value,10))){$.alert(ERR_PORT_ORDER_INVAD);var element=$.id("portEnd");if(element){element.focus();element.select()}return false}if(($.id("prelen").value!="")&&($.id("ipaddr").value=="")){$.alert(ERR_FW6_ADDR_INVAD);var element=$.id("ipaddr");if(element){element.focus();element.select()}return false}if(($.id("ipaddr").value)==""&&($.id("portStart").value=="")&&($.id("portEnd").value=="")){$.alert(ERR_TC_IP_PORT_INVAD);var element=$.id("ipaddr");if(element){element.focus();element.select()}return false}fwAttrs.type=0;fwAttrs.entryName=$.id("entryName").value;fwAttrs.IPv6Address=$.id("ipaddr").value;fwAttrs.IPv6PrefixLength=($.id("prelen").value)?$.id("prelen").value:0;fwAttrs.portStart=($.id("portStart").value)?parseInt($.id("portStart").value,10):0;fwAttrs.portEnd=($.id("portEnd").value)?parseInt($.id("portEnd").value,10):0;if(opt==0){$.act(ACT_ADD,IP6_INTERNAL_HOST,null,null,fwAttrs)}else{if(opt==1){$.act(ACT_SET,IP6_INTERNAL_HOST,stk,null,fwAttrs)}}$.addLoading($.id("saveBtn"));$.exe(function(err){if(!err){$.loadMain("fw6Lan.htm")}})};</script>

<p class="et T" id="et">IPv6 LAN HOST</p>
<div class="con1 L">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="br"></p>
<p class="L1"><b class="item T T_desc">Description:</b><input type="text" class="text" size="17" id="entryName" maxlength="15"/></p>
<div id="ipMode_elem">
<p class="L1"><b class="item T T_ip6addr">IPv6 Address:</b>
<input type="text" class="text" id="ipaddr" maxlength="39" size="17"/>
</p>
<p class="L1"><b class="item T T_plen">Prefix Length:</b>
<input type="text" class="text" id="prelen" maxlength="4" size="4"/>
</p>
<p class="L1"><b class="item T T_port">Port:</b>
<input type="text" class="text" id="portStart" size="10"/>-
<input type="text" class="text" id="portEnd" size="10"/></p>
</div>
</div>
<p class="bl"></p>
<p class="tail" id="tail">
<input type="button" class="button L T T_save" id="saveBtn" value="Save" onclick="doSave();" />
<input type="button" class="button L T T_back" value="Back" onclick="doReturn();" /></p>
</div>
<script language="javascript" type="text/javascript">$.loadHelp();init();</script>
