<script language="javascript" type="text/javascript">var realMode;function changeSec(){if("wep"==$.id("sec_select").value){$.removeClass($.id("wep_idx"),"nd")}else{$.addClass($.id("wep_idx"),"nd")}if("none"==$.id("sec_select").value){$.id("keyText").disabled=true;$.id("keyText").value=""}else{$.id("keyText").disabled=false}}function copyHostSSID(){$.id("extssid").value=wdsObj.bridgeSSID}function checkValue(){if($.id("secNone").checked==true){return true}else{if($.id("secWEP").checked==true){return checkWEP()}else{if($.id("secPSK").checked==true){return checkPSK()}else{if($.id("secWPA").checked==true){return checkWPA()}else{return false}}}}}function getParam(){beaconType=wlanObj.beaconType;basicAuthenticationMode=wlanObj.basicAuthenticationMode;WEPKeyIndex=wlanObj.WEPKeyIndex;$.each(wepList,function(arg,index){wepKeyArray[index]=this.WEPKey});wepLevel=wlanObj.WEPEncryptionLevel.split(",");basicEncryptionModes=wlanObj.basicEncryptionModes;WPAAuthenticationMode=wlanObj.WPAAuthenticationMode;WPAEncryptionModes=wlanObj.WPAEncryptionModes;IEEE11iAuthenticationMode=wlanObj.IEEE11iAuthenticationMode;IEEE11iEncryptionModes=wlanObj.IEEE11iEncryptionModes;X_TP_PreSharedKey=wlanObj.X_TP_PreSharedKey;X_TP_GroupKeyUpdateInterval=wlanObj.X_TP_GroupKeyUpdateInterval;X_TP_RadiusServerIP=wlanObj.X_TP_RadiusServerIP;X_TP_RadiusServerPort=wlanObj.X_TP_RadiusServerPort;X_TP_RadiusServerPassword=wlanObj.X_TP_RadiusServerPassword}function initShow(){var i;if(INCLUDE_LAN_WLAN_DUALBAND){$.removeClass($.id("ap_enable"),"nd")}if(INCLUDE_LAN_WLAN_HWSWITCH){$.addClass($.id("wifiswitch"),"nd")}else{if(1==wlanObj.enable){$.id("apen").checked=true}}$.id("extssid").value=wlanObj.SSID;if(beaconType=="Basic"&&basicEncryptionModes=="None"){$.id("sec_select").value="none"}else{if(beaconType=="Basic"&&basicEncryptionModes=="WEPEncryption"){$.id("sec_select").value="wep";for(i=1;i<=4;i++){if(wepKeyArray[i-1]!=""){$.id("keyText").value=wepKeyArray[i-1];$.id("wepidx").value=i;break}}}else{if(beaconType=="WPA"){if(WPAAuthenticationMode=="PSKAuthentication"){$.id("sec_select").value="wpa"}else{$.id("sec_select").value="wpa"}$.id("keyText").value=X_TP_PreSharedKey}else{if(beaconType=="11i"||beaconType=="WPAand11i"){if(IEEE11iAuthenticationMode=="PSKAuthentication"){$.id("sec_select").value="wpa"}else{$.id("sec_select").value="wpa"}$.id("keyText").value=X_TP_PreSharedKey}else{}}}}changeSec()}function initParam(){if(!$.mainParam){return}wlanObj.SSID=$.mainParam.ssid;wlanObj.standard=$.mainParam.standard;wlanObj.channel=$.mainParam.channel;wlanObj.autoChannelEnable=$.mainParam.autoChannel;wlanObj.X_TP_Bandwidth=$.mainParam.bandWidth;if(!INCLUDE_LAN_WLAN_HWSWITCH){wlanObj.enable=$.mainParam.apEn}wlanObj.SSIDAdvertisementEnabled=$.mainParam.SSIDAdvertisementEnabled}function checkParam(){var extSSID=$.id("extssid");var ssidLen=$.realLen(extSSID.value);if(ssidLen<=0){$.alert(ERR_WLAN_SSID_IS_EMPTY);extSSID.focus();extSSID.select();return false}else{if(ssidLen>32){$.alert(ERR_WLAN_SSID_LEN_OUTRANGE);extSSID.focus();extSSID.select();return false}}var key=$.id("keyText");if($.id("sec_select").value=="none"){}else{if($.id("sec_select").value=="wep"){if(key.value.length!=5&&key.value.length!=13&&key.value.length!=16&&key.value.length!=10&&key.value.length!=26&&key.value.length!=32){$.alert(ERR_WLAN_WDS_ASCII_KEY_OUTRANGE);key.focus();key.select();return false}else{if(key.value.length==5||key.value.length==13||key.value.length==16){if($.asc(key.value,true)){$.alert(ERR_WLAN_WDS_ASCII_KEY_INVALID);key.focus();key.select();return false}}else{if(key.value.length==10||key.value.length==26||key.value.length==32){if(!isHex(key.value)){key.focus();key.select();return false}}}}}else{if(key.value.length>64||key.value.length<8){$.alert(ERR_WLAN_WPA_PSK_LENGTH_INVALID);key.focus();key.select();return false}else{if(key.value.length==64){if(!isHex(key.value)){key.focus();key.select();return false}}else{if($.asc(key.value,true)){$.alert(ERR_WLAN_WPA_PSK_ASCII_INVALID);key.focus();key.select();return false}}}}}return true}function doWlanSubmit(){var ssid=$.id("extssid").value;var apEn=$.id("apen").checked?1:0;var vapIndex=0;if(INCLUDE_LAN_WLAN_DUALBAND){$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["Enable="+apEn,"SSID="+ssid,"Standard="+wlanObj.standard])}else{$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["SSID="+ssid,"Standard="+wlanObj.standard])}if($.id("sec_select").value=="none"){$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=Basic","BasicEncryptionModes=None","BasicAuthenticationMode=None"])}else{if($.id("sec_select").value=="wep"){var index=0;var authType;authType="Auto";wepKeyIdx=$.id("wepidx").value;$.each(wepList,function(arg,index){var key;if($.id("wepidx").value!=(index+1)){key=""}else{key=$.id("keyText").value}$.act(ACT_SET,LAN_WLAN_WEPKEY,this.__stack,null,["WEPKey="+key])});$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=Basic","WEPKeyIndex="+wepKeyIdx,"BasicAuthenticationMode="+authType,"BasicEncryptionModes=WEPEncryption"])}else{if($.id("sec_select").value=="wpa"){var groupInterval=X_TP_GroupKeyUpdateInterval;var encryType="AESEncryption";$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=WPAand11i","WPAEncryptionModes="+encryType,"WPAAuthenticationMode=PSKAuthentication","IEEE11iAuthenticationMode=PSKAuthentication","IEEE11iEncryptionModes="+encryType,"X_TP_PreSharedKey="+$.id("keyText").value,"X_TP_GroupKeyUpdateInterval="+groupInterval])}}}$.exe(function(ret){if(!ret){$.removeLoading()}if(srcPage){$.loadMain(srcPage)}else{$.reload()}})}function doSave(obj){if(false==$.id("apen").checked||true==checkParam()){}else{return}$.addLoading(obj);doWlanSubmit()};</script>
<p class="et"><span id="title_ext"><span class="T" id="opt">Extended Network Settings</span></span></p>
<div class="con1 M">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="nd" id="ap_enable">
<b class="item T" id="t_ext_net">Extended 2.4GHz:</b>
<input id="apen" type="checkbox"/><span class="T T_en">Enable</span>
</p>
<p>
<b class="item T" id="t_ext_ssid">Extended 2.4GHz SSID:</b><input type="text" class="T" size="24" maxlength="32" id="extssid"/>
<input id="cpssid" class="button XL T T_cpssid" type="button" value="Copy Host SSID" onclick="copyHostSSID();"/></p>
</p>
<p>
<b class="item T" id="t_ext_security">Extended 2.4GHz Security:</b><select id="sec_select" name="sec_select" onchange="changeSec();">
<option value="none" class="T T_noneEnc">No Security</option>
<option value="wpa" selected>WPA-PSK/WPA2-PSK</option>
<option value="wep">WEP</option>
</select>
</p>
<p><b class="item T" id="t_ext_password">Extended 2.4GHz Password:</b><input type=text class="T" id="keyText" size="24" /></p>
<div id="wep_idx">
<p id="t_wep_notice" style="color:#C11C66"><span style="white-space:normal;padding-left:60px">We do not recommend using the WEP encryption if this device operates in 802.11n mode due to the fact that WEP is not supported by 802.11n specification.</span></p>
<p>
<b class="item T" id="t_wepidx">Index:</b><select id="wepidx" name="wepidx" style = "width:160px">
<option value="1" class="T T_idx1" selected>1</option>
<option value="2" class="T T_idx2">2</option>
<option value="3" class="T T_idx3">3</option>
<option value="4" class="T T_idx4">4</option>
</select>
</p>
</div>
</div>
<p class="bl"></p>
<p class="tail ctr" id="tail">
<input type="button" class="button L T T_save" value="Save" id="b_save" onclick="doSave(this);" />
</p>
</div>
<script language="javascript" type="text/javascript">var srcPage=undefined;var wepKeyArray=new Array(4);if($.mainParam){if($.mainParam=="wlGuest.htm"){srcPage="wlGuest.htm";$.mainParam=undefined}}$.loadHelpFrame("WlanExtenderHelpRpm.htm");var basicList=$.act(ACT_GL,LAN_WLAN,null,null,["name","SSID","Enable","X_TP_Configuration_Modified","beaconType","Standard","WEPEncryptionLevel","WEPKeyIndex","BasicEncryptionModes","BasicAuthenticationMode","WPAEncryptionModes","WPAAuthenticationMode","IEEE11iEncryptionModes","IEEE11iAuthenticationMode","X_TP_PreSharedKey","X_TP_GroupKeyUpdateInterval","X_TP_RadiusServerIP","X_TP_RadiusServerPort","X_TP_RadiusServerPassword"]);var wlanObj,wlan52Obj,wepList,wdsObj;if(INCLUDE_LAN_WLAN_WDS){wdsObj=$.act(ACT_GET,LAN_WLAN_WDSBRIDGE,wlanObj.__stack,null,["BridgeEnable","BridgeBSSID","BridgeSSID","BridgeAuthMode","BridgeEncryptMode","BridgeKey","BridgeWepKeyIndex"])}if(!$.exe()){wlanObj=basicList[0];wlan52Obj=basicList[1];wepList=$.act(ACT_GL,LAN_WLAN_WEPKEY,null,wlanObj.__stack,["WEPKey"])}if(!$.exe()){initParam();getParam();initShow()};</script>
