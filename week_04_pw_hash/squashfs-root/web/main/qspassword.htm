<script language="javascript" type="text/javascript">function doCollect(obj){if($.id("clp").checked==false){$.qd.changPwd=0;return true}else{$.qd.changPwd=1;$.qd.newaccout={};var arg;var re=/[^\x00-\x19\x21-\xff]/;var userCfg={};var olduserCfg={};arg=$.id("curName").value;if(arg===""){$.alert(ERR_USER_OLD_NAME_EMPTY);return false}if($.asc(arg,true)){$.alert(ERR_USER_OLD_NAME_ASCII);return false}userCfg.curName=arg;arg=$.id("curPwd").value;if(arg===""){$.alert(ERR_USER_OLD_PWD_EMPTY);return false}if($.asc(arg,true)){$.alert(ERR_USER_OLD_PWD_ASCII);return false}userCfg.oldPwd=arg;olduserCfg.oldPwd=arg;olduserCfg.pwd=arg;arg=$.id("newName").value;if(re.test(arg)){$.alert(ERR_USER_NAME_HAS_SPACE);return false}if(arg===""){$.alert(ERR_USER_NAME_EMPTY);return false}if($.asc(arg,true)){$.alert(ERR_USER_NAME_ASCII);return false}userCfg.name=arg;arg=$.id("newPwd").value;if(re.test(arg)){$.alert(ERR_USER_PWD_HAS_SPACE);return false}if(arg===""){$.alert(ERR_USER_PWD_EMPTY);return false}if($.asc(arg,true)){$.alert(ERR_USER_PWD_ASCII);return false}userCfg.pwd=arg;if(arg!==$.id("cfmPwd").value){$.alert(ERR_USER_NAME_PWD_CONFLICT);return false}userCfg.cfmPwd=$.id("cfmPwd").value;$.act(ACT_CGI,"/cgi/auth");if($.exe()){return false}if($.id("curName").value!=curName){$.alert(ERR_HTTP_ERR_USER_NAME_NOT_CORRECT);return false}olduserCfg.name=curName;$.act(ACT_CGI,"/cgi/auth",null,null,olduserCfg);if(!$.exe()){$.qd.newaccout=userCfg;return true}else{$.errBack(ret,"manageCtrl.htm");return false}}}function doClear(){$.qd.changPwd=0;$.id("clp").checked=false;$.id("curName").value="";$.id("curPwd").value="";$.id("newName").value="";$.id("newPwd").value="";$.id("cfmPwd").value=""}function clicken(){if($.id("clp").checked==false){$.addClass($.id("changePass"),"nd")}else{$.removeClass($.id("changePass"),"nd")}}function changPasswordInit(){if($.qd.changPwd==1){$.id("clp").checked=true;if($.qd.newaccout.curName==undefined||$.qd.newaccout.oldPwd==undefined||$.qd.newaccout.name==undefined||$.qd.newaccout.pwd==undefined||$.qd.newaccout.cfmPwd==undefined){$.id("curName").value="";$.id("curPwd").value="";$.id("newName").value="";$.id("newPwd").value="";$.id("cfmPwd").value=""}else{$.id("curName").value=$.qd.newaccout.curName;$.id("curPwd").value=$.qd.newaccout.oldPwd;$.id("newName").value=$.qd.newaccout.name;$.id("newPwd").value=$.qd.newaccout.pwd;$.id("cfmPwd").value=$.qd.newaccout.cfmPwd}}clicken()}function goPrev(){doClear();$.qf.prev()}function goNext(){if(doCollect()){$.qf.next()}};</script>
<p class="et T" id="et">Password</p>
<div class="con1 L">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<div>
<p>
<b class="item">&nbsp;</b>
<input id="clp" type="checkbox" onclick="clicken();"/><span class="T" id="title">Change Login Password</span>
</p>
</div>
<div class="bdr L nd" id="changePass">
<p><i class="T" id="t_tip">Username and password can contain between 1 - 15 characters and may not include spaces.</i></p>
<p><b class="item L T" id="t_oldname">Old User Name:</b><input type="text" class="text" size="15" maxlength="15" style="width:121px" id="curName" /></p>
<p><b class="item L T" id="t_oldpwd">Old Password:</b><input type="password" class="text" size="15" maxlength="15" style="width:121px" id="curPwd" /></p>
<p><b class="item L T" id="t_newname">New User Name:</b><input type="text" class="text" size="15" maxlength="15" style="width:121px" id="newName" /></p>
<p><b class="item L T" id="t_newpwd">New Password:</b><input type="password" class="text" size="15" maxlength="15" style="width:121px" id="newPwd" /></p>
<p><b class="item L T" id="t_cfmpwd">Confirm Password:</b><input type="password" class="text" size="15" maxlength="15" style="width:121px" id="cfmPwd" /></p>
</div>
</div>
<p class="bl"></p>
<p class="tail" id="tail">
        <input type="button" class="button L T T_back" value="Back" onclick="goPrev()" />
        <input type="button" class="button L T T_next" value="Next" onclick="goNext()" />
</p>
</div>
<script language="javascript" type="text/javascript">$.loadHelpFrame("QsChangeLoginPwdHelpRpm.htm");changPasswordInit();</script>