<script language="javascript" type="text/javascript">function setParentMac(){$.id("parentMac").value=$.id("curPCMac").value}function copyMac(){$.id($.id("macList").value).value=$.id("curMac").value;$.id("macList").value=0}var taskSche={};var idIndex;var tmpWeek;function selTime(){var dayList=[];for(var i=0;i<14;i++){dayList[i]="00000000";for(var j=23;j>=0;j--){var tmpTimeId=24*i+j;if(idIndex[tmpTimeId]==1){dayList[i]+="1"}else{dayList[i]+="0"}}if(i==0){taskSche.sunAm=parseInt(dayList[0],2)}else{if(i==1){taskSche.sunPm=parseInt(dayList[1],2)}else{if(i==2){taskSche.monAm=parseInt(dayList[2],2)}else{if(i==3){taskSche.monPm=parseInt(dayList[3],2)}else{if(i==4){taskSche.tueAm=parseInt(dayList[4],2)}else{if(i==5){taskSche.tuePm=parseInt(dayList[5],2)}else{if(i==6){taskSche.wedAm=parseInt(dayList[6],2)}else{if(i==7){taskSche.wedPm=parseInt(dayList[7],2)}else{if(i==8){taskSche.thuAm=parseInt(dayList[8],2)}else{if(i==9){taskSche.thuPm=parseInt(dayList[9],2)}else{if(i==10){taskSche.friAm=parseInt(dayList[10],2)}else{if(i==11){taskSche.friPm=parseInt(dayList[11],2)}else{if(i==12){taskSche.satAm=parseInt(dayList[12],2)}else{if(i==13){taskSche.satPm=parseInt(dayList[13],2)}}}}}}}}}}}}}}}}function doClick(val){var tmpTimeId="timeid"+val;if(idIndex[val]==0){$.addClass($.id(tmpTimeId),"sel");idIndex[val]=1}else{if(idIndex[val]==1){$.removeClass($.id(tmpTimeId),"sel");idIndex[val]=0}}}function initTbl(){for(var i=0;i<14;i++){for(var j=23;j>=0;j--){var tmpid=24*i+j;var tmpTimeId="timeid"+tmpid;if(tmpWeek[i].charAt(j)==1){$.addClass($.id(tmpTimeId),"sel");idIndex[tmpid]=1}else{if(tmpWeek[i].charAt(j)==0){$.removeClass($.id(tmpTimeId),"sel");idIndex[tmpid]=0}}}}}function addTbl(){for(var i=0;i<14;i++){for(var j=23;j>=0;j--){var tmpid=24*i+j;var tmpTimeId="timeid"+tmpid;if(tmpWeek[i].charAt(j)==1){$.addClass($.id(tmpTimeId),"sel");idIndex[tmpid]=1}}}}function cleanTbl(){for(var i=0;i<336;i++){var tmpTimeId="timeid"+i;$.removeClass($.id(tmpTimeId),"sel");idIndex[i]=0}tmpWeek=[];for(var i=0;i<14;i++){tmpWeek[i]=""}}function initSche(){idIndex=[];var tbl=$.id("timeTbl");for(var i=0;i<7;i++){var row=tbl.insertRow(-1);for(var j=0;j<24;j++){var cell=row.insertCell(-1);var id1=i*48+2*j;var id2=i*48+2*j+1;cell.innerHTML='<span id="timeid'+id1+"\" onclick='doClick("+id1+");'></span><span id=\"timeid"+id2+"\" onclick='doClick("+id2+");'></span>"}}for(var i=0;i<336;i++){idIndex[i]=0}tmpWeek=[];for(var i=0;i<14;i++){tmpWeek[i]=""}var scheCfg=$.act(ACT_GET,TASK_SCHEDULE,"1,0,0,0,0,0",null);if(!$.exe()){while(scheCfg.sunAm>0){if(scheCfg.sunAm%2==1){tmpWeek[0]+="1"}else{if(scheCfg.sunAm%2==0){tmpWeek[0]+="0"}}scheCfg.sunAm=Math.floor(scheCfg.sunAm/2)}while(scheCfg.sunPm>0){if(scheCfg.sunPm%2==1){tmpWeek[1]+="1"}else{if(scheCfg.sunPm%2==0){tmpWeek[1]+="0"}}scheCfg.sunPm=Math.floor(scheCfg.sunPm/2)}while(scheCfg.monAm>0){if(scheCfg.monAm%2==1){tmpWeek[2]+="1"}else{if(scheCfg.monAm%2==0){tmpWeek[2]+="0"}}scheCfg.monAm=Math.floor(scheCfg.monAm/2)}while(scheCfg.monPm>0){if(scheCfg.monPm%2==1){tmpWeek[3]+="1"}else{if(scheCfg.monPm%2==0){tmpWeek[3]+="0"}}scheCfg.monPm=Math.floor(scheCfg.monPm/2)}while(scheCfg.tueAm>0){if(scheCfg.tueAm%2==1){tmpWeek[4]+="1"}else{if(scheCfg.tueAm%2==0){tmpWeek[4]+="0"}}scheCfg.tueAm=Math.floor(scheCfg.tueAm/2)}while(scheCfg.tuePm>0){if(scheCfg.tuePm%2==1){tmpWeek[5]+="1"}else{if(scheCfg.tuePm%2==0){tmpWeek[5]+="0"}}scheCfg.tuePm=Math.floor(scheCfg.tuePm/2)}while(scheCfg.wedAm>0){if(scheCfg.wedAm%2==1){tmpWeek[6]+="1"}else{if(scheCfg.wedAm%2==0){tmpWeek[6]+="0"}}scheCfg.wedAm=Math.floor(scheCfg.wedAm/2)}while(scheCfg.wedPm>0){if(scheCfg.wedPm%2==1){tmpWeek[7]+="1"}else{if(scheCfg.wedPm%2==0){tmpWeek[7]+="0"}}scheCfg.wedPm=Math.floor(scheCfg.wedPm/2)}while(scheCfg.thuAm>0){if(scheCfg.thuAm%2==1){tmpWeek[8]+="1"}else{if(scheCfg.thuAm%2==0){tmpWeek[8]+="0"}}scheCfg.thuAm=Math.floor(scheCfg.thuAm/2)}while(scheCfg.thuPm>0){if(scheCfg.thuPm%2==1){tmpWeek[9]+="1"}else{if(scheCfg.thuPm%2==0){tmpWeek[9]+="0"}}scheCfg.thuPm=Math.floor(scheCfg.thuPm/2)}while(scheCfg.friAm>0){if(scheCfg.friAm%2==1){tmpWeek[10]+="1"}else{if(scheCfg.friAm%2==0){tmpWeek[10]+="0"}}scheCfg.friAm=Math.floor(scheCfg.friAm/2)}while(scheCfg.friPm>0){if(scheCfg.friPm%2==1){tmpWeek[11]+="1"}else{if(scheCfg.friPm%2==0){tmpWeek[11]+="0"}}scheCfg.friPm=Math.floor(scheCfg.friPm/2)}while(scheCfg.satAm>0){if(scheCfg.satAm%2==1){tmpWeek[12]+="1"}else{if(scheCfg.satAm%2==0){tmpWeek[12]+="0"}}scheCfg.satAm=Math.floor(scheCfg.satAm/2)}while(scheCfg.satPm>0){if(scheCfg.satPm%2==1){tmpWeek[13]+="1"}else{if(scheCfg.satPm%2==0){tmpWeek[13]+="0"}}scheCfg.satPm=Math.floor(scheCfg.satPm/2)}initTbl()}}function showWeek(){if($.id("weekDay").value=="day"){$.addClass($.id("week"),"nd")}else{if($.id("weekDay").value=="week"){$.id("mon").checked=0;$.id("tue").checked=0;$.id("wed").checked=0;$.id("thu").checked=0;$.id("fri").checked=0;$.id("sat").checked=0;$.id("sun").checked=0;$.removeClass($.id("week"),"nd")}}}function addTime(){tmpWeek=[];for(var i=0;i<14;i++){tmpWeek[i]=""}var timeS=parseInt($.id("timeS").value,10);var timeE=parseInt($.id("timeE").value,10);if(timeS==timeE+1){timeS=0;timeE=47}if(timeS<timeE+1){if($.id("weekDay").value=="day"){if((timeS<24)&&(timeE<24)){for(var i=0;i<timeS;i++){tmpWeek[0]+="0";tmpWeek[2]+="0";tmpWeek[4]+="0";tmpWeek[6]+="0";tmpWeek[8]+="0";tmpWeek[10]+="0";tmpWeek[12]+="0"}for(var i=timeS;i<=timeE;i++){tmpWeek[0]+="1";tmpWeek[2]+="1";tmpWeek[4]+="1";tmpWeek[6]+="1";tmpWeek[8]+="1";tmpWeek[10]+="1";tmpWeek[12]+="1"}for(var i=(timeE+1);i<24;i++){tmpWeek[0]+="0";tmpWeek[2]+="0";tmpWeek[4]+="0";tmpWeek[6]+="0";tmpWeek[8]+="0";tmpWeek[10]+="0";tmpWeek[12]+="0"}}else{if((timeS>23)&&(timeE>23)){for(var i=24;i<timeS;i++){tmpWeek[1]+="0";tmpWeek[3]+="0";tmpWeek[5]+="0";tmpWeek[7]+="0";tmpWeek[9]+="0";tmpWeek[11]+="0";tmpWeek[13]+="0"}for(var i=timeS;i<=timeE;i++){tmpWeek[1]+="1";tmpWeek[3]+="1";tmpWeek[5]+="1";tmpWeek[7]+="1";tmpWeek[9]+="1";tmpWeek[11]+="1";tmpWeek[13]+="1"}for(var i=(timeE+1);i<48;i++){tmpWeek[1]+="0";tmpWeek[3]+="0";tmpWeek[5]+="0";tmpWeek[7]+="0";tmpWeek[9]+="0";tmpWeek[11]+="0";tmpWeek[13]+="0"}}else{if((timeS<24)&&(timeE>23)){for(var i=0;i<timeS;i++){tmpWeek[0]+="0";tmpWeek[2]+="0";tmpWeek[4]+="0";tmpWeek[6]+="0";tmpWeek[8]+="0";tmpWeek[10]+="0";tmpWeek[12]+="0"}for(var i=timeS;i<24;i++){tmpWeek[0]+="1";tmpWeek[2]+="1";tmpWeek[4]+="1";tmpWeek[6]+="1";tmpWeek[8]+="1";tmpWeek[10]+="1";tmpWeek[12]+="1"}for(var i=24;i<=timeE;i++){tmpWeek[1]+="1";tmpWeek[3]+="1";tmpWeek[5]+="1";tmpWeek[7]+="1";tmpWeek[9]+="1";tmpWeek[11]+="1";tmpWeek[13]+="1"}for(var i=(timeE+1);i<48;i++){tmpWeek[1]+="0";tmpWeek[3]+="0";tmpWeek[5]+="0";tmpWeek[7]+="0";tmpWeek[9]+="0";tmpWeek[11]+="0";tmpWeek[13]+="0"}}}}}else{if($.id("weekDay").value=="week"){if((timeS<24)&&(timeE<24)){for(var i=0;i<timeS;i++){if($.id("sun").checked==1){tmpWeek[0]+="0"}if($.id("mon").checked==1){tmpWeek[2]+="0"}if($.id("tue").checked==1){tmpWeek[4]+="0"}if($.id("wed").checked==1){tmpWeek[6]+="0"}if($.id("thu").checked==1){tmpWeek[8]+="0"}if($.id("fri").checked==1){tmpWeek[10]+="0"}if($.id("sat").checked==1){tmpWeek[12]+="0"}}for(var i=timeS;i<=timeE;i++){if($.id("sun").checked==1){tmpWeek[0]+="1"}if($.id("mon").checked==1){tmpWeek[2]+="1"}if($.id("tue").checked==1){tmpWeek[4]+="1"}if($.id("wed").checked==1){tmpWeek[6]+="1"}if($.id("thu").checked==1){tmpWeek[8]+="1"}if($.id("fri").checked==1){tmpWeek[10]+="1"}if($.id("sat").checked==1){tmpWeek[12]+="1"}}for(var i=(timeE+1);i<24;i++){if($.id("sun").checked==1){tmpWeek[0]+="0"}if($.id("mon").checked==1){tmpWeek[2]+="0"}if($.id("tue").checked==1){tmpWeek[4]+="0"}if($.id("wed").checked==1){tmpWeek[6]+="0"}if($.id("thu").checked==1){tmpWeek[8]+="0"}if($.id("fri").checked==1){tmpWeek[10]+="0"}if($.id("sat").checked==1){tmpWeek[12]+="0"}}}else{if((timeS>23)&&(timeE>23)){for(var i=24;i<timeS;i++){if($.id("sun").checked==1){tmpWeek[1]+="0"}if($.id("mon").checked==1){tmpWeek[3]+="0"}if($.id("tue").checked==1){tmpWeek[5]+="0"}if($.id("wed").checked==1){tmpWeek[7]+="0"}if($.id("thu").checked==1){tmpWeek[9]+="0"}if($.id("fri").checked==1){tmpWeek[11]+="0"}if($.id("sat").checked==1){tmpWeek[13]+="0"}}for(var i=timeS;i<=timeE;i++){if($.id("sun").checked==1){tmpWeek[1]+="1"}if($.id("mon").checked==1){tmpWeek[3]+="1"}if($.id("tue").checked==1){tmpWeek[5]+="1"}if($.id("wed").checked==1){tmpWeek[7]+="1"}if($.id("thu").checked==1){tmpWeek[9]+="1"}if($.id("fri").checked==1){tmpWeek[11]+="1"}if($.id("sat").checked==1){tmpWeek[13]+="1"}}for(var i=(timeE+1);i<24;i++){if($.id("sun").checked==1){tmpWeek[1]+="0"}if($.id("mon").checked==1){tmpWeek[3]+="0"}if($.id("tue").checked==1){tmpWeek[5]+="0"}if($.id("wed").checked==1){tmpWeek[7]+="0"}if($.id("thu").checked==1){tmpWeek[9]+="0"}if($.id("fri").checked==1){tmpWeek[11]+="0"}if($.id("sat").checked==1){tmpWeek[13]+="0"}}}else{if((timeS<24)&&(timeE>23)){for(var i=0;i<timeS;i++){if($.id("sun").checked==1){tmpWeek[0]+="0"}if($.id("mon").checked==1){tmpWeek[2]+="0"}if($.id("tue").checked==1){tmpWeek[4]+="0"}if($.id("wed").checked==1){tmpWeek[6]+="0"}if($.id("thu").checked==1){tmpWeek[8]+="0"}if($.id("fri").checked==1){tmpWeek[10]+="0"}if($.id("sat").checked==1){tmpWeek[12]+="0"}}for(var i=timeS;i<24;i++){if($.id("sun").checked==1){tmpWeek[0]+="1"}if($.id("mon").checked==1){tmpWeek[2]+="1"}if($.id("tue").checked==1){tmpWeek[4]+="1"}if($.id("wed").checked==1){tmpWeek[6]+="1"}if($.id("thu").checked==1){tmpWeek[8]+="1"}if($.id("fri").checked==1){tmpWeek[10]+="1"}if($.id("sat").checked==1){tmpWeek[12]+="1"}}for(var i=24;i<=timeE;i++){if($.id("sun").checked==1){tmpWeek[1]+="1"}if($.id("mon").checked==1){tmpWeek[3]+="1"}if($.id("tue").checked==1){tmpWeek[5]+="1"}if($.id("wed").checked==1){tmpWeek[7]+="1"}if($.id("thu").checked==1){tmpWeek[9]+="1"}if($.id("fri").checked==1){tmpWeek[11]+="1"}if($.id("sat").checked==1){tmpWeek[13]+="1"}}for(var i=(timeE+1);i<24;i++){if($.id("sun").checked==1){tmpWeek[1]+="0"}if($.id("mon").checked==1){tmpWeek[3]+="0"}if($.id("tue").checked==1){tmpWeek[5]+="0"}if($.id("wed").checked==1){tmpWeek[7]+="0"}if($.id("thu").checked==1){tmpWeek[9]+="0"}if($.id("fri").checked==1){tmpWeek[11]+="0"}if($.id("sat").checked==1){tmpWeek[13]+="0"}}}}}}}}else{if($.id("weekDay").value=="day"){if((timeS<24)&&(timeE+1<24)){for(var i=0;i<timeE+1;i++){tmpWeek[0]+="1";tmpWeek[2]+="1";tmpWeek[4]+="1";tmpWeek[6]+="1";tmpWeek[8]+="1";tmpWeek[10]+="1";tmpWeek[12]+="1"}for(var i=timeE+1;i<timeS;i++){tmpWeek[0]+="0";tmpWeek[2]+="0";tmpWeek[4]+="0";tmpWeek[6]+="0";tmpWeek[8]+="0";tmpWeek[10]+="0";tmpWeek[12]+="0"}for(var i=timeS;i<24;i++){tmpWeek[0]+="1";tmpWeek[2]+="1";tmpWeek[4]+="1";tmpWeek[6]+="1";tmpWeek[8]+="1";tmpWeek[10]+="1";tmpWeek[12]+="1"}for(var i=0;i<24;i++){tmpWeek[1]+="1";tmpWeek[3]+="1";tmpWeek[5]+="1";tmpWeek[7]+="1";tmpWeek[9]+="1";tmpWeek[11]+="1";tmpWeek[13]+="1"}}else{if((timeS>23)&&(timeE+1>23)){for(var i=24;i<timeE+1;i++){tmpWeek[1]+="1";tmpWeek[3]+="1";tmpWeek[5]+="1";tmpWeek[7]+="1";tmpWeek[9]+="1";tmpWeek[11]+="1";tmpWeek[13]+="1"}for(var i=timeE+1;i<timeS;i++){tmpWeek[1]+="0";tmpWeek[3]+="0";tmpWeek[5]+="0";tmpWeek[7]+="0";tmpWeek[9]+="0";tmpWeek[11]+="0";tmpWeek[13]+="0"}for(var i=timeS;i<48;i++){tmpWeek[1]+="1";tmpWeek[3]+="1";tmpWeek[5]+="1";tmpWeek[7]+="1";tmpWeek[9]+="1";tmpWeek[11]+="1";tmpWeek[13]+="1"}for(var i=0;i<24;i++){tmpWeek[0]+="1";tmpWeek[2]+="1";tmpWeek[4]+="1";tmpWeek[6]+="1";tmpWeek[8]+="1";tmpWeek[10]+="1";tmpWeek[12]+="1"}}else{if((timeE+1<24)&&(timeS>23)){for(var i=0;i<timeE+1;i++){tmpWeek[0]+="1";tmpWeek[2]+="1";tmpWeek[4]+="1";tmpWeek[6]+="1";tmpWeek[8]+="1";tmpWeek[10]+="1";tmpWeek[12]+="1"}for(var i=timeE+1;i<24;i++){tmpWeek[0]+="0";tmpWeek[2]+="0";tmpWeek[4]+="0";tmpWeek[6]+="0";tmpWeek[8]+="0";tmpWeek[10]+="0";tmpWeek[12]+="0"}for(var i=24;i<timeS;i++){tmpWeek[1]+="0";tmpWeek[3]+="0";tmpWeek[5]+="0";tmpWeek[7]+="0";tmpWeek[9]+="0";tmpWeek[11]+="0";tmpWeek[13]+="0"}for(var i=timeS;i<48;i++){tmpWeek[1]+="1";tmpWeek[3]+="1";tmpWeek[5]+="1";tmpWeek[7]+="1";tmpWeek[9]+="1";tmpWeek[11]+="1";tmpWeek[13]+="1"}}}}}else{if($.id("weekDay").value=="week"){if((timeS<24)&&(timeE+1<24)){for(var i=0;i<timeE+1;i++){tmpWeek[2]+=($.id("sun").checked==1)?"1":"0";tmpWeek[4]+=($.id("mon").checked==1)?"1":"0";tmpWeek[6]+=($.id("tue").checked==1)?"1":"0";tmpWeek[8]+=($.id("wed").checked==1)?"1":"0";tmpWeek[10]+=($.id("thu").checked==1)?"1":"0";tmpWeek[12]+=($.id("fri").checked==1)?"1":"0";tmpWeek[0]+=($.id("sat").checked==1)?"1":"0"}for(var i=timeE+1;i<timeS;i++){if($.id("sun").checked==1){tmpWeek[0]+="0"}if($.id("mon").checked==1){tmpWeek[2]+="0"}if($.id("tue").checked==1){tmpWeek[4]+="0"}if($.id("wed").checked==1){tmpWeek[6]+="0"}if($.id("thu").checked==1){tmpWeek[8]+="0"}if($.id("fri").checked==1){tmpWeek[10]+="0"}if($.id("sat").checked==1){tmpWeek[12]+="0"}}for(var i=timeS;i<24;i++){if($.id("sun").checked==1){tmpWeek[0]+="1"}if($.id("mon").checked==1){tmpWeek[2]+="1"}if($.id("tue").checked==1){tmpWeek[4]+="1"}if($.id("wed").checked==1){tmpWeek[6]+="1"}if($.id("thu").checked==1){tmpWeek[8]+="1"}if($.id("fri").checked==1){tmpWeek[10]+="1"}if($.id("sat").checked==1){tmpWeek[12]+="1"}}for(var i=0;i<24;i++){if($.id("sun").checked==1){tmpWeek[1]+="1"}if($.id("mon").checked==1){tmpWeek[3]+="1"}if($.id("tue").checked==1){tmpWeek[5]+="1"}if($.id("wed").checked==1){tmpWeek[7]+="1"}if($.id("thu").checked==1){tmpWeek[9]+="1"}if($.id("fri").checked==1){tmpWeek[11]+="1"}if($.id("sat").checked==1){tmpWeek[13]+="1"}}}else{if((timeS>23)&&(timeE+1>23)){for(var i=24;i<timeE+1;i++){tmpWeek[3]+=($.id("sun").checked==1)?"1":"0";tmpWeek[5]+=($.id("mon").checked==1)?"1":"0";tmpWeek[7]+=($.id("tue").checked==1)?"1":"0";tmpWeek[9]+=($.id("wed").checked==1)?"1":"0";tmpWeek[11]+=($.id("thu").checked==1)?"1":"0";tmpWeek[13]+=($.id("fri").checked==1)?"1":"0";tmpWeek[1]+=($.id("sat").checked==1)?"1":"0"}for(var i=timeE+1;i<timeS;i++){if($.id("sun").checked==1){tmpWeek[1]+="0"}if($.id("mon").checked==1){tmpWeek[3]+="0"}if($.id("tue").checked==1){tmpWeek[5]+="0"}if($.id("wed").checked==1){tmpWeek[7]+="0"}if($.id("thu").checked==1){tmpWeek[9]+="0"}if($.id("fri").checked==1){tmpWeek[11]+="0"}if($.id("sat").checked==1){tmpWeek[13]+="0"}}for(var i=timeS;i<48;i++){if($.id("sun").checked==1){tmpWeek[1]+="1"}if($.id("mon").checked==1){tmpWeek[3]+="1"}if($.id("tue").checked==1){tmpWeek[5]+="1"}if($.id("wed").checked==1){tmpWeek[7]+="1"}if($.id("thu").checked==1){tmpWeek[9]+="1"}if($.id("fri").checked==1){tmpWeek[11]+="1"}if($.id("sat").checked==1){tmpWeek[13]+="1"}}for(var i=0;i<24;i++){tmpWeek[2]+=($.id("sun").checked==1)?"1":"0";tmpWeek[4]+=($.id("mon").checked==1)?"1":"0";tmpWeek[6]+=($.id("tue").checked==1)?"1":"0";tmpWeek[8]+=($.id("wed").checked==1)?"1":"0";tmpWeek[10]+=($.id("thu").checked==1)?"1":"0";tmpWeek[12]+=($.id("fri").checked==1)?"1":"0";tmpWeek[0]+=($.id("sat").checked==1)?"1":"0"}}else{if((timeE+1<24)&&(timeS>23)){for(var i=0;i<timeE+1;i++){tmpWeek[2]+=($.id("sun").checked==1)?"1":"0";tmpWeek[4]+=($.id("mon").checked==1)?"1":"0";tmpWeek[6]+=($.id("tue").checked==1)?"1":"0";tmpWeek[8]+=($.id("wed").checked==1)?"1":"0";tmpWeek[10]+=($.id("thu").checked==1)?"1":"0";tmpWeek[12]+=($.id("fri").checked==1)?"1":"0";tmpWeek[0]+=($.id("sat").checked==1)?"1":"0"}for(var i=timeE+1;i<24;i++){if($.id("sun").checked==1){tmpWeek[0]+="0"}if($.id("mon").checked==1){tmpWeek[2]+="0"}if($.id("tue").checked==1){tmpWeek[4]+="0"}if($.id("wed").checked==1){tmpWeek[6]+="0"}if($.id("thu").checked==1){tmpWeek[8]+="0"}if($.id("fri").checked==1){tmpWeek[10]+="0"}if($.id("sat").checked==1){tmpWeek[12]+="0"}}for(var i=24;i<timeS;i++){if($.id("sun").checked==1){tmpWeek[1]+="0"}if($.id("mon").checked==1){tmpWeek[3]+="0"}if($.id("tue").checked==1){tmpWeek[5]+="0"}if($.id("wed").checked==1){tmpWeek[7]+="0"}if($.id("thu").checked==1){tmpWeek[9]+="0"}if($.id("fri").checked==1){tmpWeek[11]+="0"}if($.id("sat").checked==1){tmpWeek[13]+="0"}}for(var i=timeS;i<48;i++){if($.id("sun").checked==1){tmpWeek[1]+="1"}if($.id("mon").checked==1){tmpWeek[3]+="1"}if($.id("tue").checked==1){tmpWeek[5]+="1"}if($.id("wed").checked==1){tmpWeek[7]+="1"}if($.id("thu").checked==1){tmpWeek[9]+="1"}if($.id("fri").checked==1){tmpWeek[11]+="1"}if($.id("sat").checked==1){tmpWeek[13]+="1"}}}}}}}}addTbl()}var selAll;var index;var allUrl;var allUrlType;var fwAttrs;var fwCfg;var delList;var delListIndex;var delFlag;function doSelAll(){if(selAll==0){for(var i=1;i<=index;i++){var urlid="urlid"+i;$.id(urlid).checked=1}selAll=1}else{if(selAll==1){for(var i=1;i<=index;i++){var urlid="urlid"+i;$.id(urlid).checked=0}selAll=0}}}function initUrlTbl(){var urlTbl=$.id("urltbl");while(urlTbl.rows.length>0){urlTbl.deleteRow(-1)}index=0;for(var i=0;i<allUrl.length;i++){var row=urlTbl.insertRow(-1);index++;var cell=row.insertCell(-1);cell.width="20px";cell.innerHTML="<input type='checkbox' id='urlid"+index+"' onclick='clickSel();'/>";cell=row.insertCell(-1);cell.innerHTML=allUrl[i]}$.resize($.id("urltbl"),8)}function doAddUrl(){var urlTbl=$.id("urltbl");if(($.id("urlInfo").value=="")||(!$.isdomain($.id("urlInfo").value))){$.alert(ERR_FW_URL_INVAD);var element=$.id("urlInfo");if(element){element.focus();element.select()}return}var row=urlTbl.insertRow(-1);index++;var cell=row.insertCell(-1);cell.width="20px";cell.innerHTML="<input type='checkbox' id='urlid"+index+"' onclick='clickSel();'/>";cell=row.insertCell(-1);cell.innerHTML=$.id("urlInfo").value;$.resize($.id("urltbl"),8);allUrl[index-1]=$.id("urlInfo").value;allUrlType[index-1]=0;$.id("urlInfo").value=""}function doDelUrl(){var urlTbl=$.id("urltbl");for(var i=1;i<=urlTbl.rows.length;i++){var tmpEntryId="urlid"+i;if($.id(tmpEntryId).checked==1){if(allUrlType[i-1]!=0){delList[delListIndex]=allUrl[i-1];delListIndex++;delFlag=1}allUrl[i-1]="";allUrlType[i-1]=""}}var tmpAllUrl=[];var tmpAllUrlType=[];for(var j=0;j<allUrl.length;j++){tmpAllUrl[j]=allUrl[j];tmpAllUrlType[j]=allUrlType[j]}index=0;allUrl=[];allUrlType=[];for(var j=0;j<tmpAllUrl.length;j++){if((tmpAllUrl[j]!="")||(tmpAllUrlType[j]!="")){allUrl[index]=tmpAllUrl[j];allUrlType[index]=tmpAllUrlType[j];index++}}initUrlTbl()}function init(){initSche();$.act(ACT_CGI,"/cgi/lanMac");$.act(ACT_CGI,"/cgi/info");var fwInfo=$.act(ACT_GET,FIREWALL,null,null,["enalbeParentCtrl","parentMac"]);var macCfg1=$.act(ACT_GET,INTERNAL_HOST,"1,0,0,0,0,0",null,["mac"]);var macCfg2=$.act(ACT_GET,INTERNAL_HOST,"2,0,0,0,0,0",null,["mac"]);var macCfg3=$.act(ACT_GET,INTERNAL_HOST,"3,0,0,0,0,0",null,["mac"]);var macCfg4=$.act(ACT_GET,INTERNAL_HOST,"4,0,0,0,0,0",null,["mac"]);selAll=0;index=0;allUrl=[];allUrlType=[];fwAttrs={};delList=[];delListIndex=0;delFlag=0;var urlTbl=$.id("urltbl");fwCfg=$.act(ACT_GET,EXTERNAL_HOST,"1,0,0,0,0,0",null);var urlCfgList=$.act(ACT_GL,URL_CFG,null,null,["urlAddr"]);if(!$.exe()){$.id("ParentCtr_en").checked=(fwInfo.enalbeParentCtrl==1)?1:0;$.id("parentMac").value=fwInfo.parentMac;$.id("curPCMac").value=clientMac;$.id("mac1").value=macCfg1.mac;$.id("mac2").value=macCfg2.mac;$.id("mac3").value=macCfg3.mac;$.id("mac4").value=macCfg4.mac;var sel=$.id("curMac");for(var i=0;i<lanMacs.length;i++){var option=$.c("option");option.value=lanMacs[i];option.text=lanMacs[i];try{sel.add(option,null)}catch(e){sel.add(option)}}for(var i=0;i<fwCfg.urlIndexs.length;i++){if(fwCfg.urlIndexs.charAt(i)==1){allUrl[index]=urlCfgList[i].urlAddr;allUrlType[index]=1;index++}}initUrlTbl()}}function doClkSave(){if(($.id("parentMac").value!="")&&($.mac($.id("parentMac").value,true))){$.alert(ERR_MAC_FORMAT);var element=$.id("parentMac");if(element){element.focus();element.select()}return false}var tmpParentCtr_en=($.id("ParentCtr_en").checked==1)?1:0;var tmpParentMac=($.id("parentMac").value)?$.id("parentMac").value:"";$.act(ACT_SET,FIREWALL,null,null,["enalbeParentCtrl="+tmpParentCtr_en,"parentMac="+tmpParentMac]);$.addLoading($.id("saveClkBtn"));$.exe(function(err){if(!err){$.removeLoading()}})}function doSave(){if(($.id("mac1").value!="")&&($.mac($.id("mac1").value,true))){$.alert(ERR_MAC_FORMAT);var element=$.id("mac1");if(element){element.focus();element.select()}return false}if(($.id("mac2").value!="")&&($.mac($.id("mac2").value,true))){$.alert(ERR_MAC_FORMAT);var element=$.id("mac2");if(element){element.focus();element.select()}return false}if(($.id("mac3").value!="")&&($.mac($.id("mac3").value,true))){$.alert(ERR_MAC_FORMAT);var element=$.id("mac3");if(element){element.focus();element.select()}return false}if(($.id("mac4").value!="")&&($.mac($.id("mac4").value,true))){$.alert(ERR_MAC_FORMAT);var element=$.id("mac4");if(element){element.focus();element.select()}return false}var tmpMac1=($.id("mac1").value)?$.id("mac1").value:"";var tmpMac2=($.id("mac2").value)?$.id("mac2").value:"";var tmpMac3=($.id("mac3").value)?$.id("mac3").value:"";var tmpMac4=($.id("mac4").value)?$.id("mac4").value:"";$.act(ACT_SET,INTERNAL_HOST,"1,0,0,0,0,0",null,["mac="+tmpMac1]);$.act(ACT_SET,INTERNAL_HOST,"2,0,0,0,0,0",null,["mac="+tmpMac2]);$.act(ACT_SET,INTERNAL_HOST,"3,0,0,0,0,0",null,["mac="+tmpMac3]);$.act(ACT_SET,INTERNAL_HOST,"4,0,0,0,0,0",null,["mac="+tmpMac4]);selTime();$.act(ACT_SET,TASK_SCHEDULE,"1,0,0,0,0,0",null,taskSche);if(delFlag==1){for(var i=0;i<delList.length;i++){fwAttrs.addUrl=0;fwAttrs.tmpUrl=delList[i];$.act(ACT_SET,EXTERNAL_HOST,"1,0,0,0,0,0",null,fwAttrs)}}for(var i=0;i<allUrl.length;i++){fwAttrs.type=2;fwAttrs.addUrl=1;fwAttrs.tmpUrl=allUrl[i].toLowerCase();$.act(ACT_SET,EXTERNAL_HOST,"1,0,0,0,0,0",null,fwAttrs)}$.addLoading($.id("saveBtn"));$.exe(function(err){if(!err){$.reload()}})}function clickSel(){if(selAll==1){$.id("selAll").checked=0;selAll=0}}init();</script>
<p class="et T" id="et">Parent Control</p>
<div class="con1 L">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="L1 T" id="t_info">Parent Control function can be used to control the Internet activities of children/guests and limit the access to specified websites during specified time period.</p>
<p class="L1"><span class="T T_scheduleTip">The Schedule is based on the time of the Router. The time can be set in "System Tools -></span><span class="a T T_timeSet" style="color:#C11C66" onclick="$.loadMain('time.htm');"> Time Settings</span>".</p>
<p class="br"></p>
<p><input type="checkbox" id="ParentCtr_en" checked /><span class="T" id="t_en">Enable Parent Control</span></p>
<p class="br"></p>
<p class="L2"><b class="item L T" id="t_pmac">MAC Address Of Parental PC:</b><input type="text" class="text" size="17" id="parentMac" maxlength="17"/></p>
<p class="L2"><b class="item L T" id="t_curmac">MAC Address of Current PC:</b><input type="text" class="text" size="17" id="curPCMac" disabled />&nbsp;&nbsp;<input type="button" class="button T" id="t_copy1" value="Copy to Above" onclick="setParentMac();"/></p>
<p class="br"></p>
<p class="L1"><input type="button" class="button L T T_save" id="saveClkBtn" value="Save" onclick="doClkSave();" /></p>
<p class="br"></p>
<p class="bl"></p>

<div class="bdr L">
<p class="L1"><b class="item L"><span class="T T_macaddr">MAC Address</span> - 1:</b><input type="text" class="text" size="17" maxlength="17" id="mac1"/></p>
<p class="L1"><b class="item L"><span class="T T_macaddr">MAC Address</span> - 2:</b><input type="text" class="text" size="17" maxlength="17" id="mac2"/></p>
<p class="L1"><b class="item L"><span class="T T_macaddr">MAC Address</span> - 3:</b><input type="text" class="text" size="17" maxlength="17" id="mac3"/></p>
<p class="L1"><b class="item L"><span class="T T_macaddr">MAC Address</span> - 4:</b><input type="text" class="text" size="17" maxlength="17" id="mac4"/></p>
<p class="br"></p>
<p class="L1"><b class="item L T" id="t_lanmac">MAC Address in current LAN:</b>
<select class="XL" id="curMac"></select> <span class="T" id="t_copy2">Copy to</span>
<select class="L" id="macList" onchange="copyMac();">
<option value=0 class="T" id="t_sel">--Please Select--</option>
<option value="mac1" class="T" id="t_mac1">MAC Address-1</option>
<option value="mac2" class="T" id="t_mac2">MAC Address-2</option>
<option value="mac3" class="T" id="t_mac3">MAC Address-3</option>
<option value="mac4" class="T" id="t_mac4">MAC Address-4</option>
</select></p>
</div>
<p class="br"></p>
<p class="bl"></p>

<div>
<p><b class="fl L ml T" id="t_setto">Apply To:</b><b class="fl L T" id="t_start">Start Time:</b><b class="fl L T" id="t_end">End Time:</b></p>
<p><b class="fl L"><select id="weekDay" class="M" onchange="showWeek();">
<option value="day" class="T" id="t_day">Each Day</option>
<option value="week" class="T" id="t_week">Each Week</option>
</select></b>
<b class="fl L">
<select id="timeS" class="M">
<option value=0>00:00</option><option value=1>00:30</option>
<option value=2>01:00</option><option value=3>01:30</option>
<option value=4>02:00</option><option value=5>02:30</option>
<option value=6>03:00</option><option value=7>03:30</option>
<option value=8>04:00</option><option value=9>04:30</option>
<option value=10>05:00</option><option value=11>05:30</option>
<option value=12>06:00</option><option value=13>06:30</option>
<option value=14>07:00</option><option value=15>07:30</option>
<option value=16>08:00</option><option value=17>08:30</option>
<option value=18>09:00</option><option value=19>09:30</option>
<option value=20>10:00</option><option value=21>10:30</option>
<option value=22>11:00</option><option value=23>11:30</option>
<option value=24>12:00</option><option value=25>12:30</option>
<option value=26>13:00</option><option value=27>13:30</option>
<option value=28>14:00</option><option value=29>14:30</option>
<option value=30>15:00</option><option value=31>15:30</option>
<option value=32>16:00</option><option value=33>16:30</option>
<option value=34>17:00</option><option value=35>17:30</option>
<option value=36>18:00</option><option value=37>18:30</option>
<option value=38>19:00</option><option value=39>19:30</option>
<option value=40>20:00</option><option value=41>20:30</option>
<option value=42>21:00</option><option value=43>21:30</option>
<option value=44>22:00</option><option value=45>22:30</option>
<option value=46>23:00</option><option value=47>23:30</option>
</select></b>
<b class="fl L">
<select id="timeE" class="M">
<option value=0>00:30</option>
<option value=1>01:00</option><option value=2>01:30</option>
<option value=3>02:00</option><option value=4>02:30</option>
<option value=5>03:00</option><option value=6>03:30</option>
<option value=7>04:00</option><option value=8>04:30</option>
<option value=9>05:00</option><option value=10>05:30</option>
<option value=11>06:00</option><option value=12>06:30</option>
<option value=13>07:00</option><option value=14>07:30</option>
<option value=15>08:00</option><option value=16>08:30</option>
<option value=17>09:00</option><option value=18>09:30</option>
<option value=19>10:00</option><option value=20>10:30</option>
<option value=21>11:00</option><option value=22>11:30</option>
<option value=23>12:00</option><option value=24>12:30</option>
<option value=25>13:00</option><option value=26>13:30</option>
<option value=27>14:00</option><option value=28>14:30</option>
<option value=29>15:00</option><option value=30>15:30</option>
<option value=31>16:00</option><option value=32>16:30</option>
<option value=33>17:00</option><option value=34>17:30</option>
<option value=35>18:00</option><option value=36>18:30</option>
<option value=37>19:00</option><option value=38>19:30</option>
<option value=39>20:00</option><option value=40>20:30</option>
<option value=41>21:00</option><option value=42>21:30</option>
<option value=43>22:00</option><option value=44>22:30</option>
<option value=45>23:00</option><option value=46>23:30</option>
<option value=47 selected>24:00</option>
</select></b>
<input type="button" class="button L T T_add" value="Add" onclick="addTime();"/>
</p>
<div id="week" class="nd">
<p class="br"></p>
<p>
<input type="checkbox" id="mon"/><span class="T T_mon">Mon.</span>&nbsp;&nbsp;
<input type="checkbox" id="tue"/><span class="T T_tues">Tues.</span>&nbsp;&nbsp;
<input type="checkbox" id="wed"/><span class="T T_wed">Wed.</span>&nbsp;&nbsp;
<input type="checkbox" id="thu"/><span class="T T_thur">Thur.</span>&nbsp;&nbsp;
<input type="checkbox" id="fri"/><span class="T T_fri">Fri.</span>&nbsp;&nbsp;
<input type="checkbox" id="sat"/><span class="T T_sat">Sat.</span>&nbsp;&nbsp;
<input type="checkbox" id="sun"/><span class="T T_sun">Sun.</span>
</p>
</div>
<p class="br"></p>
<div style="width: 524px; margin: 0 auto;">
<div style="float: left; width: 40px; padding: 1px 0 0 1px;">
<table class="week" style="border-collapse: collapse;" cellpadding="0" cellspacing="0">
	<tr><th style="height: 35px;" class="T T_time">Time</th></tr>
	<tr><th class="T T_sun">Sun.</th></tr>
	<tr><th class="T T_mon">Mon.</th></tr>
	<tr><th class="T T_tues">Tues.</th></tr>
	<tr><th class="T T_wed">Wed.</th></tr>
	<tr><th class="T T_thur">Thur.</th></tr>
	<tr><th class="T T_fri">Fri.</th></tr>
	<tr><th class="T T_sat">Sat.</th></tr>
</table>
</div>
<div style="overflow-x: scroll; width: 481px; padding: 1px 0 0 1px; float: left;">
<table id="timeTbl" class="cale bdr" style="border-collapse: collapse; width: 769px; table-layout: fixed;" cellpadding="0" cellspacing="0">
<tr height="35px">
	<th>0:00</th><th>1:00 </th><th>2:00</th><th>3:00</th><th>4:00</th><th>5:00</th>
	<th>6:00</th><th>7:00</th><th>8:00</th><th>9:00</th><th>10:00</th><th>11:00</th>
	<th>12:00</th><th>13:00</th><th>14:00</th><th>15:00</th><th>16:00</th><th>17:00</th>
	<th>18:00</th><th>19:00</th><th>20:00</th><th>21:00</th><th>22:00</th><th>23:00</th>
</tr></table>
</div>
</div>
<div class="clr"></div>
<p class="br"></p>
<p><input type="button" class="button XL T" id="t_clear" value="Clear Schedule" onclick="cleanTbl();"></p>
</div>
<p class="br"></p>
<p class="bl"></p>

<div class="bdr L">
<p class="L1"><b class="item T" id="t_url">Add URL:</b>
<input type="text" class="text" size="25" id="urlInfo" maxlength="32"/>
<input type="button" class="button L T T_add" value="Add" onclick="doAddUrl();"/>
</p>
<p class="br"></p>
<div class="M thead" ><table class="M bdr tc">
<tr>
<th width="20px"><input type="checkbox" id="selAll" onclick="doSelAll();"/></th>
<th class="T" id="t_detail">Details</th>
</tr>
</table></div>
<div class="M tbody"><table id="urltbl" class="M bdr tc"></table></div>
<p class="br"></p>
<p class="L1">
<input type="button" class="button XL T T_delsel" value="Delete Selected" onclick="doDelUrl();"/>&nbsp;&nbsp;<span class="T" id="t_apply">(It will not take effect until you save it.)</span></p>
</div>

</div>
<p class="bl"></p>
<p class="tail" id="tail">
<input type="button" class="button L T T_save" id="saveBtn" value="Save" onclick="doSave();" /></p>
</div>
<script language="javascript" type="text/javascript">$.loadHelpFrame("ParentCtrlHelpRpm.htm");</script>
