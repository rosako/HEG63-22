<script language="javascript" type="text/javascript">var mainChannel;var authMode,encryptMode;var cfgModified=false;function isHex(str){str=str.toLowerCase();for(var i=0;i<str.length;i++){if((str.charAt(i)>="0"&&str.charAt(i)<="9")||(str.charAt(i)>="a"&&str.charAt(i)<="f")){continue}else{$.alert(ERR_WLAN_WDS_HEX_KEY_INVALID);return false}}if(parseInt(str,16)==0){$.alert(ERR_WLAN_WDS_HEX_KEY_OUTRANGE);return false}return true}function hide_wep(){$.addClass($.id("wep_security"),"nd");$.addClass($.id("password"),"nd");$.id("wepidx").disabled=true;$.id("authType").disabled=true;$.id("wepkeyFormat").disabled=true;$.id("keyText").disabled=true}function show_wep(){$.removeClass($.id("wep_security"),"nd");$.removeClass($.id("password"),"nd");$.id("wepidx").disabled=false;$.id("authType").disabled=false;$.id("wepkeyFormat").disabled=false;$.id("keyText").disabled=false}function hide_psk(){$.addClass($.id("wpa_tkip_notice"),"nd");$.addClass($.id("password"),"nd");$.id("keyText").disabled=true}function show_psk(){if(encryptMode!="TKIPEncryption"){encryptMode="AESEncryption"}else{$.removeClass($.id("wpa_tkip_notice"),"nd")}$.removeClass($.id("password"),"nd");$.id("keyText").disabled=false}function changeSec(){if($.id("host_re").checked==false){if("wep"==$.id("keyType").value){hide_psk();show_wep()}else{if("none"==$.id("keyType").value){hide_psk();hide_wep()}else{hide_wep();show_psk()}}$.id("keyType").disabled=true;$.id("bridgeSSID").disabled=true;$.id("t_scanner").disabled=true}else{$.id("keyText").disabled=false;$.id("keyType").disabled=false;$.id("bridgeSSID").disabled=false;$.id("wep_security").disabled=false;$.id("t_scanner").disabled=false;if("wep"==$.id("keyType").value){hide_psk();show_wep()}else{if("none"==$.id("keyType").value){hide_psk();hide_wep()}else{hide_wep();show_psk()}}}cfgModified=true}if(INCLUDE_LAN_WLAN_WDS){function initWDS(){if(1==wdsObj.bridgeEnable||$.mainParam){$.id("host_re").checked=true}else{$.id("host_re").checked=false}if($.mainParam&&$.mainParam.wdsExist==1){$.id("bridgeSSID").value=$.mainParam.SSID;$.id("bridgeBSSID").value=$.mainParam.BSSID;mainChannel=$.mainParam.channel;if($.mainParam.authMode==0&&$.mainParam.wepStatus==1){$.id("keyType").selectedIndex=0}else{if($.mainParam.wepStatus==0||$.mainParam.authMode==2){$.id("keyType").selectedIndex=3;if($.mainParam.authMode==1){$.id("authType").selectedIndex=1}else{if($.mainParam.authMode==0){$.id("authType").selectedIndex=0}}$.id("wepidx").selectedIndex=wdsObj.bridgeWepKeyIndex-1}else{if($.mainParam.authMode==3||$.mainParam.authMode==5||$.mainParam.authMode==4){$.id("keyType").selectedIndex=1}else{if($.mainParam.authMode==6||$.mainParam.authMode==7){$.id("keyType").selectedIndex=2}else{$.id("keyType").selectedIndex=3}}}}if($.id("keyType").value=="none"){authMode="Open";encryptMode="None"}else{if($.id("keyType").value=="wep"){encryptMode="WEPEncryption";if($.id("authType").value=="open"){authMode="Open"}else{authMode="SharedAuthentication"}}else{if($.id("keyType").value=="wpa"){authMode="PSKAuthentication";encryptMode="AESEncryption"}else{if($.id("keyType").value=="wpa2"){authMode="PSK2Authentication";encryptMode="AESEncryption"}else{authMode="PSK2Authentication";encryptMode="AESEncryption"}}}}if($.mainParam.wepStatus==4){if($.mainParam.authMode==3||$.mainParam.authMode==5||$.mainParam.authMode==4){authMode="PSKAuthentication"}else{authMode="PSK2Authentication"}encryptMode="TKIPEncryption"}}else{$.id("bridgeSSID").value=wdsObj.bridgeSSID;$.id("bridgeBSSID").value=wdsObj.bridgeBSSID;if(wlanObj.channel!=6){mainChannel=6}else{mainChannel=5}authMode=wdsObj.BridgeAuthMode;encryptMode=wdsObj.bridgeEncryptMode;if(wdsObj.bridgeAuthMode=="Open"&&wdsObj.bridgeEncryptMode=="None"){$.id("keyType").selectedIndex=0;$.id("keyText").value=""}else{if(wdsObj.bridgeEncryptMode=="WEPEncryption"){$.id("keyType").selectedIndex=3;if(wdsObj.bridgeAuthMode=="SharedAuthentication"){$.id("authType").selectedIndex=1}else{if(wdsObj.bridgeAuthMode="Open"){$.id("authType").selectedIndex=0}}if(wdsObj.bridgeKey.length==5||wdsObj.bridgeKey.length==13||wdsObj.bridgeKey.length==16){$.id("wepkeyFormat").selectedIndex=0}else{if(wdsObj.bridgeKey.length==10||wdsObj.bridgeKey.length==26||wdsObj.bridgeKey.length==32){$.id("wepkeyFormat").selectedIndex=1}}$.id("wepidx").selectedIndex=wdsObj.bridgeWepKeyIndex-1;$.id("keyText").value=wdsObj.bridgeKey}else{if(wdsObj.bridgeAuthMode=="PSKAuthentication"){$.id("keyType").selectedIndex=1;$.id("keyText").value=wdsObj.bridgeKey}else{if(wdsObj.bridgeAuthMode=="PSK2Authentication"){$.id("keyType").selectedIndex=2;$.id("keyText").value=wdsObj.bridgeKey}else{$.id("keyType").selectedIndex=3;$.id("keyText").value=wdsObj.bridgeKey}}}}}changeSec()}}function initShow(){if(INCLUDE_LAN_WLAN_WDS){initWDS()}}function initParam(){if(!$.mainParam){return}wlanObj.SSID=$.mainParam.ssid;wlanObj.standard=$.mainParam.standard;wlanObj.channel=$.mainParam.channel;wlanObj.autoChannelEnable=$.mainParam.autoChannel;wlanObj.X_TP_Bandwidth=$.mainParam.bandWidth;wlanObj.SSIDAdvertisementEnabled=$.mainParam.SSIDAdvertisementEnabled}function apScan(obj){$.act(ACT_OP,ACT_OP_WLAN_SCAN,wlanObj.__stack);$.addLoading(obj);param=new Object();param.ssid=wlanObj.SSID;param.standard=wlanObj.standard;param.channel=wlanObj.channel;param.autoChannel=wlanObj.autoChannelEnable;param.bandWidth=wlanObj.X_TP_Bandwidth;param.multiMode=1;param.apEn=1;param.SSIDAdvertisementEnabled=wlanObj.SSIDAdvertisementEnabled;$.exe(function(ret){if(!ret){$.loadMain("wlScan.htm",param)}})}function checkWDS(){var briSSID=$.id("bridgeSSID");var ssidLen=$.realLen(briSSID.value);if(ssidLen<=0){$.alert(ERR_WLAN_WDS_SSID_IS_EMPTY);briSSID.focus();briSSID.select();return false}else{if(ssidLen>32){$.alert(ERR_WLAN_WDS_SSID_LEN_OUTRANGE);briSSID.focus();briSSID.select();return false}}var bss=$.id("bridgeBSSID");if(bss.value.length==0){$.alert(ERR_WLAN_WDS_BSSID_IS_EMPTY);bss.focus();bss.select();return false}else{if($.mac(bss.value,true)){$.alert(ERR_WLAN_WDS_BSSID_INVALID);bss.focus();bss.select();return false}}var key=$.id("keyText");if($.id("keyType").value=="none"){}else{if($.id("keyType").value=="wep"){if($.id("wepkeyFormat").value=="ascii"){if(key.value.length!=5&&key.value.length!=13&&key.value.length!=16){$.alert(ERR_WLAN_WDS_ASCII_KEY_OUTRANGE);key.focus();key.select();return false}else{if($.asc(key.value,true)){$.alert(ERR_WLAN_WDS_ASCII_KEY_INVALID);key.focus();key.select();return false}}}else{if($.id("wepkeyFormat").value=="hex"){if(key.value.length!=10&&key.value.length!=26&&key.value.length!=32){$.alert(ERR_WLAN_WDS_HEX_KEY_OUTRANGE);key.focus();key.select();return false}else{if(!isHex(key.value)){key.focus();key.select();return false}}}}}else{if(key.value.length>64||key.value.length<8){$.alert(ERR_WLAN_WDS_PSK_OUTRANGE);key.focus();key.select();return false}else{if(key.value.length==64){if(!isHex(key.value)){key.focus();key.select();return false}}else{if($.asc(key.value,true)){$.alert(ERR_WLAN_WDS_ASCII_KEY_INVALID);key.focus();key.select();return false}}}}}return true}function doSubmit(){var arg2g={};var index=0;var ssid=$.id("bridgeSSID").value;if(INCLUDE_LAN_WLAN_WDS){var wdsEn=$.id("host_re").checked?1:0}var vapIndex=0;if($.id("keyType").value=="none"){authMode="Open";encryptMode="None"}else{if($.id("keyType").value=="wep"){encryptMode="WEPEncryption";if($.id("authType").value=="open"){authMode="Open"}else{authMode="SharedAuthentication"}}else{if($.id("keyType").value=="wpa"){authMode="PSKAuthentication"}else{if($.id("keyType").value=="wpa2"){authMode="PSK2Authentication"}else{authMode="PSK2Authentication"}}}}if(INCLUDE_LAN_WLAN_WDS){if(1==wdsEn){if(INCLUDE_LAN_WLAN_DUALBAND){$.act(ACT_SET,LAN_WLAN_WDSBRIDGE,wlan5GObj.__stack,null,["BridgeEnable=0"])}$.act(ACT_SET,LAN_WLAN_WDSBRIDGE,wdsObj.__stack,null,["BridgeEnable="+wdsEn,"BridgeBSSID="+$.id("bridgeBSSID").value,"BridgeSSID="+$.id("bridgeSSID").value,"BridgeAuthMode="+authMode,"BridgeEncryptMode="+encryptMode,"BridgeKey="+$.id("keyText").value,"BridgeWepKeyIndex="+$.id("wepidx").value])}else{$.act(ACT_SET,LAN_WLAN_WDSBRIDGE,wdsObj.__stack,null,["BridgeEnable="+wdsEn])}}arg2g.enable=1;arg2g.SSID=ssid?ssid:wlanObj.SSID;arg2g.autoChannelEnable=0;arg2g.Channel=mainChannel?mainChannel:wlanObj.channel;arg2g.Standard=wlanObj.standard;arg2g.X_TP_Bandwidth=wlanObj.X_TP_Bandwidth;if($.id("keyType").value!="none"){if(encryptMode=="WEPEncryption"){arg2g.beaconType="Basic";arg2g.BasicEncryptionModes="WEPEncryption";arg2g.BasicAuthenticationMode=(authMode=="Open")?"None":"SharedAuthentication";arg2g.WEPKeyIndex=$.id("wepidx").value;$.each(wepList,function(arg,index){var key;if($.id("wepidx").value!=(index+1)){key=""}else{key=$.id("keyText").value}$.act(ACT_SET,LAN_WLAN_WEPKEY,this.__stack,null,["WEPKey="+key])});$.act(ACT_SET,LAN_WLAN_WPS,wlanObj.__stack,null,["enable="+0])}else{arg2g.beaconType="11i";arg2g.IEEE11iEncryptionModes="AESEncryption";arg2g.WPAEncryptionModes="AESEncryption";arg2g.WPAAuthenticationMode="PSKAuthentication";arg2g.IEEE11iAuthenticationMode="PSKAuthentication";arg2g.X_TP_PreSharedKey=$.id("keyText").value}}else{arg2g.beaconType="Basic";arg2g.basicEncryptionModes="None";arg2g.BasicAuthenticationMode="None"}$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,arg2g);$.exe(function(ret){if(!ret){$.removeLoading()}if(srcPage){$.loadMain(srcPage)}else{$.reload()}})}function doSave(obj){if(INCLUDE_LAN_WLAN_WDS){if(false==$.id("host_re").checked||true==checkWDS()){}else{return}}$.addLoading(obj);doSubmit()};</script>
<p class="et"><span id="title_connect"><span class="T" id="opt">Connect to Host Network</span></span></p>
<div class="con1 M">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p id="bridgeEnable" class="nd">
<b class="item T" id="t_host_net">2.4GHz Network:</b>
<input id="host_re" type="checkbox" onclick="changeSec();"/><span class="T T_en">Connect to 2.4GHz Network</span>
</p>
<p>
<b class="item T" id="t_brssid">SSID(to be bridged):</b><input type="text" class="T" size="24" maxlength="32" id="bridgeSSID"/>
</p>
<p>
<b class="item T" id="t_brbssid">MAC Address(to be bridged):</b><input type="text" class="T" size="24" maxlength="32" id="bridgeBSSID"/>
</p>
<p><b class="item">&nbsp;</b>
&nbsp;<input type="button" class="button L T" id="t_scanner" value="Wireless Scanner" style="width:140px" onclick="apScan(this);" />
</p>
<p>
<b class="item T T_security">Security:</b><select id="keyType" name="keyType" style="width:160px" onchange="changeSec();">
<option value="none" class="T T_noneEnc">No Security</option>
<option value="wpa" selected>WPA-PSK</option>
<option value="wpa2" selected>WPA2-PSK</option>
<option value="wep">WEP</option>
</select>
</p>
<div id="wpa_tkip_notice" class="nd">
<p id="t_tkip_notice" style="color:#C11C66"><span style="white-space:normal;padding-left:60px">We do not recommend using the TKIP encryption if this device operates in 802.11n mode due to the fact that TKIP is not supported by 802.11n specification.</span></p>
</div>
<div id="wep_security">
<p id="t_wep_notice" style="color:#C11C66"><span style="white-space:normal;padding-left:60px">We do not recommend using the WEP encryption if this device operates in 802.11n mode due to the fact that WEP is not supported by 802.11n specification.</span></p>
<p><b class="item T" id="t_wepidx">Index:</b><select id="wepidx" name="wepidx" style="width:160px">
<option value="1" class="T T_idx1" selected>1</option>
<option value="2" class="T T_idx2">2</option>
<option value="3" class="T T_idx3">3</option>
<option value="4" class="T T_idx4">4</option>
</select></p>
<p><b class="item T T_authtype">WEP Authentication Type:</b><select id="authType" name="authType" style="width:160px">
<option class="T T_opensys" value="open">Open System</option>
<option class="T T_sharekey" value="shared">Shared Key</option>
</select></p>
<p><b class="item T" id="t_weptype">WEP KeyFormat:</b><select id="wepkeyFormat" name="wepkeyFormat" style="width:160px">
<option class="T T_ascii" value="ascii">ASCII</option>
<option class="T T_hex" value="hex">Hexadecimal</option>
</select></p>
</div>
<div id="password">
<p><b class="item T T_passwd">Password:</b><input type=text class="T" id="keyText" size="24" /></p>
</div>
<p id="t_cpcfg_info" style="color:#C11C66"><span style="white-space:normal;padding-left:60px">The configuration modified here will be automatically synchronized to the extended network settings</span></p>
</div>
<p class="bl"></p>
<p class="tail ctr" id="tail">
<input type="button" class="button L T T_save" value="Save" id="b_save" onclick="doSave(this);" />
</p>
</div>
<script language="javascript" type="text/javascript">var srcPage=undefined;if($.mainParam){if($.mainParam=="wlGuest.htm"){srcPage="wlGuest.htm";$.mainParam=undefined}}$.loadHelpFrame("WlanConnectHelpRpm.htm");if(INCLUDE_LAN_WLAN_DUALBAND){$.removeClass($.id("bridgeEnable"),"nd")}var basicList=$.act(ACT_GL,LAN_WLAN,null,null,["name","Standard","SSID","RegulatoryDomain","PossibleChannels","RegulatoryDomain","AutoChannelEnable","Channel","X_TP_Bandwidth","Enable","SSIDAdvertisementEnabled","BeaconType","BasicEncryptionModes","WPAEncryptionModes","IEEE11iEncryptionModes","X_TP_Configuration_Modified","WMMEnable","X_TP_FragmentThreshold"]);var wlanObj,wdsObj,wpsObj,wepList,qssEnable,wlan5GObj,isChangeRegion;if(!$.exe()){wlanObj=basicList[0];wlan5GObj=basicList[1];wepList=$.act(ACT_GL,LAN_WLAN_WEPKEY,null,wlanObj.__stack,["WEPKey"])}if(INCLUDE_LAN_WLAN_WDS){wdsObj=$.act(ACT_GET,LAN_WLAN_WDSBRIDGE,wlanObj.__stack,null,["BridgeEnable","BridgeAddrMode","BridgeBSSID","BridgeSSID","BridgeAuthMode","BridgeEncryptMode","BridgeKey","BridgeWepKeyIndex"])}if(!$.exe()){initParam();initShow()};</script>
