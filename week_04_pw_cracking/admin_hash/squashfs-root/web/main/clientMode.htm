<script language="javascript" type="text/javascript">function isHex(str){str=str.toLowerCase();for(var i=0;i<str.length;i++){if((str.charAt(i)>="0"&&str.charAt(i)<="9")||(str.charAt(i)>="a"&&str.charAt(i)<="f")){continue}else{$.alert(ERR_WLAN_WDS_HEX_KEY_INVALID);return false}}if(parseInt(str,16)==0){$.alert(ERR_WLAN_WDS_HEX_KEY_OUTRANGE);return false}return true}if(INCLUDE_LAN_WLAN_WDS_DETECT){function changeAddrMode(){wlanObj.bridgeAddrMode=$.id("addrMode").value}}function hide_wep(){$.addClass($.id("wep_security"),"nd");$.addClass($.id("password"),"nd");$.id("wepKeyIndex").disabled=true;$.id("authType").disabled=true;$.id("wepkeyFormat").disabled=true;$.id("keyText").disabled=true}function show_wep(){$.removeClass($.id("wep_security"),"nd");$.removeClass($.id("password"),"nd");$.id("wepKeyIndex").disabled=false;$.id("authType").disabled=false;$.id("wepkeyFormat").disabled=false;$.id("keyText").disabled=false}function hide_psk(){$.addClass($.id("wpa_tkip_notice"),"nd");$.addClass($.id("password"),"nd");$.id("secType").disabled=true;$.id("keyText").disabled=true}function show_psk(){$.removeClass($.id("password"),"nd");$.id("secType").disabled=false;$.id("keyText").disabled=false;if($.id("secType").selectedIndex!=0){$.id("secType").selectedIndex==1}else{$.removeClass($.id("wpa_tkip_notice"),"nd")}}function changeWDSKeyType(){var keyType=$.id("keyType").value;if("None"==keyType){hide_wep();hide_psk()}else{if("WEP"==keyType){hide_psk();show_wep()}else{hide_wep();show_psk()}}}function checkWDS(){var briSSID=$.id("bridgeSSID");var ssidLen=$.realLen(briSSID.value);if(ssidLen<=0){$.alert(ERR_WLAN_WDS_SSID_IS_EMPTY);briSSID.focus();briSSID.select();return false}else{if(ssidLen>32){$.alert(ERR_WLAN_WDS_SSID_LEN_OUTRANGE);briSSID.focus();briSSID.select();return false}}var bss=$.id("bridgeBSSID");if(bss.value.length==0){$.alert(ERR_WLAN_WDS_BSSID_IS_EMPTY);bss.focus();bss.select();return false}else{if($.mac(bss.value,true)){$.alert(ERR_WLAN_WDS_BSSID_INVALID);bss.focus();bss.select();return false}}var key=$.id("keyText");if($.id("keyType").value=="None"){}else{if($.id("keyType").value=="WEP"){if($.id("wepkeyFormat").value=="ascii"){if(key.value.length!=5&&key.value.length!=13&&key.value.length!=16){$.alert(ERR_WLAN_WDS_ASCII_KEY_OUTRANGE);key.focus();key.select();return false}else{if($.asc(key.value,true)){$.alert(ERR_WLAN_WDS_ASCII_KEY_INVALID);key.focus();key.select();return false}}}else{if($.id("wepkeyFormat").value=="hex"){if(key.value.length!=10&&key.value.length!=26&&key.value.length!=32){$.alert(ERR_WLAN_WDS_HEX_KEY_OUTRANGE);key.focus();key.select();return false}else{if(!isHex(key.value)){key.focus();key.select();return false}}}}}else{if(key.value.length>64||key.value.length<8){$.alert(ERR_WLAN_WDS_PSK_OUTRANGE);key.focus();key.select();return false}else{if(key.value.length==64){if(!isHex(key.value)){key.focus();key.select();return false}}else{if($.asc(key.value,true)){$.alert(ERR_WLAN_WDS_ASCII_KEY_INVALID);key.focus();key.select();return false}}}}}return true}function checkSSID(){var s=$.id("ssid");var ssidLen=$.realLen(s.value);if(INCLUDE_LAN_WLAN_MSSID){var index=1;for(index=1;index<ssidNum;index++){var cp1=$.id("ssid").value;var cp2=$.id("ssid"+index).value;if(cp1==cp2){$.alert(CMM_WLAN_SSID_CONFLICTE);s.focus();s.select();return false}}for(index=1;index<ssidNum;index++){var cp1=$.id("ssid"+index).value;var loop=0;for(loop=index+1;loop<ssidNum;loop++){var cp2=$.id("ssid"+loop).value;if(cp1==cp2){$.alert(CMM_WLAN_SSID_CONFLICTE);$.id("ssid"+index).focus();$.id("ssid"+index).select();return false}}}if(INCLUDE_LAN_WLAN_GUESTNETWORK){if($.id("ssid").value==guestVap.ssid){$.alert(CMM_WLAN_SSID_CONFLICTE_WITH_GUESTNET);s.focus();s.select();return false}for(index=1;index<ssidNum;index++){if($.id("ssid"+index).value==guestVap.ssid){$.alert(CMM_WLAN_SSID_CONFLICTE_WITH_GUESTNET);$.id("ssid"+index).focus();$.id("ssid"+index).select();return false}}}}if(ssidLen<=0){$.alert(ERR_WLAN_SSID_IS_EMPTY);s.focus();s.select();return false}else{if(ssidLen>32){$.alert(ERR_WLAN_SSID_LEN_OUTRANGE);s.focus();s.select();return false}else{if(INCLUDE_LAN_WLAN_MSSID){for(index=1;index<ssidNum;index++){var s2=$.id("ssid"+index);var ssidLen2=$.realLen(s2.value);if(ssidLen2<=0){$.alert(ERR_WLAN_SSID_IS_EMPTY);s2.focus();s2.select();return false}else{if(ssidLen2>32){$.alert(ERR_WLAN_SSID_LEN_OUTRANGE);s2.focus();s2.select();return false}}}}}}return true}function doSubmit(){var authMode,encryptMode,addrMode;if(INCLUDE_LAN_WLAN_WDS_DETECT){if($.id("addrMode").value=="detect"){addrMode="detect"}else{if($.id("addrMode").value=="addr4"){addrMode="addr4"}else{addrMode="addr3"}}}if($.id("keyType").value=="None"){authMode="Open";encryptMode="None"}else{if($.id("keyType").value=="WEP"){encryptMode="WEPEncryption";if($.id("authType").value=="open"){authMode="Open"}else{authMode="SharedAuthentication"}}else{if($.id("keyType").value=="WPA-PSK"){authMode="PSKAuthentication"}else{authMode="PSK2Authentication"}if($.id("secType").value=="tkip"){encryptMode="TKIPEncryption"}else{encryptMode="AESEncryption"}}}$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["AutoChannelEnable=0","Channel="+wlanObj.channel,"SSIDAdvertisementEnabled=0"]);if(INCLUDE_LAN_WLAN_DUALBAND){$.act(ACT_SET,LAN_WLAN_WDSBRIDGE,wlanObj5g.__stack,null,["BridgeEnable=0"])}if(INCLUDE_LAN_WLAN_WDS_DETECT){$.act(ACT_SET,LAN_WLAN_WDSBRIDGE,wdsObj.__stack,null,["BridgeEnable=1","BridgeBSSID="+$.id("bridgeBSSID").value,"BridgeSSID="+$.id("bridgeSSID").value,"BridgeAddrMode="+addrMode,"BridgeAuthMode="+authMode,"BridgeEncryptMode="+encryptMode,"BridgeKey="+$.id("keyText").value,"BridgeWepKeyIndex="+$.id("wepKeyIndex").value])}else{$.act(ACT_SET,LAN_WLAN_WDSBRIDGE,wdsObj.__stack,null,["BridgeEnable=1","BridgeBSSID="+$.id("bridgeBSSID").value,"BridgeSSID="+$.id("bridgeSSID").value,"BridgeAuthMode="+authMode,"BridgeEncryptMode="+encryptMode,"BridgeKey="+$.id("keyText").value,"BridgeWepKeyIndex="+$.id("wepKeyIndex").value])}$.exe(function(ret){if(!ret){if(!INCLUDE_LAN_WLAN_HWSWITCH){}else{$.removeLoading()}}$.reload()})}function initWDS(){if(!INCLUDE_LAN_WLAN_WDS_DETECT){$.addClass($.id("wdsdetect"),"nd")}else{if(1==wdsObj.bridgeEnable){$.id("addrMode").value=wdsObj.bridgeAddrMode}}if($.mainParam&&$.mainParam.wdsExist==1){$.id("bridgeSSID").value=$.mainParam.SSID;$.id("bridgeBSSID").value=$.mainParam.BSSID;if($.mainParam.authMode==0&&$.mainParam.wepStatus==1){$.id("keyType").selectedIndex=0}else{if($.mainParam.wepStatus==0){$.id("keyType").selectedIndex=1;if($.mainParam.authMode==1){$.id("authType").selectedIndex=1}else{if($.mainParam.authMode==0){$.id("authType").selectedIndex=0}}$.id("wepKeyIndex").selectedIndex=wdsObj.bridgeWepKeyIndex-1}else{if($.mainParam.authMode==4){$.id("keyType").selectedIndex=2}else{$.id("keyType").selectedIndex=3}if($.mainParam.wepStatus==4){$.id("secType").selectedIndex=0}else{$.id("secType").selectedIndex=1}}}}else{if(1==wdsObj.bridgeEnable){$.id("bridgeSSID").value=wdsObj.bridgeSSID;$.id("bridgeBSSID").value=wdsObj.bridgeBSSID;if(wdsObj.bridgeAuthMode=="Open"&&wdsObj.bridgeEncryptMode=="None"){$.id("keyType").selectedIndex=0}else{if(wdsObj.bridgeEncryptMode=="WEPEncryption"){$.id("keyType").selectedIndex=1;if(wdsObj.bridgeAuthMode=="SharedAuthentication"){$.id("authType").selectedIndex=1}else{if(wdsObj.bridgeAuthMode="Open"){$.id("authType").selectedIndex=0}}$.id("keyText").value=wdsObj.bridgeKey;if(wdsObj.bridgeKey.length==5||wdsObj.bridgeKey.length==13||wdsObj.bridgeKey.length==16){$.id("wepkeyFormat").selectedIndex=0}else{if(wdsObj.bridgeKey.length==10||wdsObj.bridgeKey.length==26||wdsObj.bridgeKey.length==32){$.id("wepkeyFormat").selectedIndex=1}}$.id("wepKeyIndex").selectedIndex=wdsObj.bridgeWepKeyIndex-1}else{if(wdsObj.bridgeAuthMode=="PSKAuthentication"){$.id("keyType").selectedIndex=2}else{$.id("keyType").selectedIndex=3}if(wdsObj.bridgeEncryptMode=="TKIPEncryption"){$.id("secType").selectedIndex=0}else{$.id("secType").selectedIndex=1}$.id("keyText").value=wdsObj.bridgeKey}}}}changeWDSKeyType()}function initShow(){initWDS()}function initParam(){if(!$.mainParam){return}wlanObj.SSID=$.mainParam.ssid;wlanObj.standard=$.mainParam.standard;wlanObj.channel=$.mainParam.channel;wlanObj.autoChannelEnable=$.mainParam.autoChannel;wlanObj.X_TP_Bandwidth=$.mainParam.bandWidth;if(!INCLUDE_LAN_WLAN_HWSWITCH){wlanObj.enable=1}wlanObj.SSIDAdvertisementEnabled=$.mainParam.SSIDAdvertisementEnabled}function apScan(obj){$.act(ACT_OP,ACT_OP_WLAN_SCAN,wlanObj.__stack);$.addLoading(obj);param=new Object();param.ssid=wlanObj.SSID;param.standard=wlanObj.standard;param.channel=wlanObj.channel;param.autoChannel=wlanObj.AutoChannelEnable;param.bandWidth=wlanObj.X_TP_Bandwidth;if(!INCLUDE_LAN_WLAN_HWSWITCH){param.apEn=1}param.SSIDAdvertisementEnabled=1;param.loadFlag=1;$.exe(function(ret){if(!ret){$.loadMain("wlScanClient.htm",param)}})}function doSave(obj){if(true==checkWDS()){$.addLoading(obj);doSubmit()}else{return false}};</script>
<p class="et T" id="et">Connect to Host Network</p>
<div id="wdsShow">
<p class="br"></p>
<p>
<b class="item T" id="t_brssid">SSID(to be bridged):</b><input type="text" class="text" size="32" maxlength="32" id="bridgeSSID"/>
</p>
<p>
<b class="item T" id="t_brbssid">MAC Address(to be bridged):</b><input type="text" class="text" maxlength="17" size="17" id="bridgeBSSID" />&nbsp;<span class="T" id="t_eg">e.g. 00:1D:0F:11:22:33</span></p>
<p><b class="item">&nbsp;</b>
&nbsp;<input type="button" class="button L T" id="t_scan" value="Wireless Scanner" onclick="apScan(this);" />
</p>
<div id="wdsdetect">
<p><b class="item T" id="t_wdsdetect">AddrMode:</b><select id="addrMode" name="addrMode" style = "width:150px" onchange="changeAddrMode();">
<option value="detect">Auto Detect</option>
<option value="addr3">Three Addr</option>
<option value="addr4">Four Addr</option>
</select></p>
</div>

<p><b class="item T T_security">Security:</b><select id="keyType" name="keyType" style = "width:150px" onchange="changeWDSKeyType();">
<option class="T T_noneEnc" value="None">No Security</option>
<option value="WEP">WEP</option>
<option value="WPA-PSK">WPA-PSK</option>
<option value="WPA2-PSK">WPA2-PSK</option>
</select></p>
<div id="wep_security">
<p id="t_wep_notice" style="color:#C11C66"><span style="white-space:normal;padding-left:60px">We do not recommend using the WEP encryption if this device operates in 802.11n mode due to the fact that WEP is not supported by 802.11n specification.</span></p>
<p><b class="item T" id="t_wepidx">WEP Index:</b><select id="wepKeyIndex" name="wepKeyIndex" style = "width:150px">
<option value=1>1</option>
<option value=2>2</option>
<option value=3>3</option>
<option value=4>4</option>
</select></p>
<p><b class="item T T_authtype">WEP Authentication Type:</b><select id="authType" name="authType" style="width:150px">
<option class="T T_opensys" value="open">Open System</option>
<option class="T T_sharekey" value="shared">Shared Key</option>
</select></p>
<p><b class="item T T_weptype ">WEP KeyFormat:</b><select id="wepkeyFormat" name="wepkeyFormat" style="width:150px">
<option class="T T_ascii" value="ascii">ASCII</option>
<option class="T T_hex" value="hex">Hexadecimal</option>
</select></p>
</div>
<div id="wpa_security" class="nd">
<p><b class="item T T_encryption">Encryption:</b><select id="secType" name="secType" style="width:150px">
<option value="tkip">TKIP</option>
<option value="aes" selected="selected">AES</option>
</select></p>
</div>
<div id="wpa_tkip_notice" class="nd">
<p id="t_tkip_notice" style="color:#C11C66"><span style="white-space:normal;padding-left:60px">We do not recommend using the TKIP encryption if this device operates in 802.11n mode due to the fact that TKIP is not supported by 802.11n specification.</span></p>
</div>
<p id="password"><b class="item T T_passwd">Password:</b><input type=text class="text" id="keyText" size="32" /></p>
</div>

</div>
<p class="bl"></p>
<p class="tail" id="tail">
<input type="button" class="button L T T_save" value="Save" onclick="doSave(this);" />
</p>
</div>

<script language="JavaScript" type="text/javascript">var srcPage=undefined;if($.mainParam){if($.mainParam=="wlGuest.htm"){srcPage="wlGuest.htm";$.mainParam=undefined}else{if($.mainParam.iptv==1){iptv=$.mainParam;$.mainParam=undefined}}}$.loadHelpFrame("WlanConnectHelpRpm.htm");var basicList=$.act(ACT_GL,LAN_WLAN,null,null,["name","Standard","SSID","RegulatoryDomain","PossibleChannels","RegulatoryDomain","AutoChannelEnable","Channel","X_TP_Bandwidth","Enable","SSIDAdvertisementEnabled","BeaconType","BasicEncryptionModes","WPAEncryptionModes","IEEE11iEncryptionModes","X_TP_Configuration_Modified","WMMEnable","X_TP_FragmentThreshold"]);var wlanObj,wdsObj,wlanObj5g;if(!$.exe()){wlanObj=basicList[0];wlanObj5g=basicList[1];wdsObj=$.act(ACT_GET,LAN_WLAN_WDSBRIDGE,wlanObj.__stack,null,["BridgeEnable","BridgeAddrMode","BridgeBSSID","BridgeSSID","BridgeAuthMode","BridgeEncryptMode","BridgeKey","BridgeWepKeyIndex"]);if(!$.exe()){initParam();initShow()}}else{alert("error")};</script>

