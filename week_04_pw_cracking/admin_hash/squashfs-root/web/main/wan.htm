<script language="javascript" type="text/javascript">function doAdd(){$.loadMain("div.htm")}function doEdit(val1,val2){for(var i=0;i<$.wd.conn.length;i++){if($.wd.conn[i].obj.__stack==val2){if(((val1==1)&&($.wd.conn[i].type.indexOf("ppp")<0))||((val1==2)&&($.wd.conn[i].type.indexOf("ppp")>=0))){$.wd.editIndex=i;break}}}$.loadMain("div.htm")}function doDel(val1,val2){var stk=val2;if(confirm(c_str.del_con)){$.lock();if(val1==1){$.act(ACT_DEL,WAN_IP_CONN,stk,null)}else{if(val1==2){$.act(ACT_DEL,WAN_PPP_CONN,stk,null)}}$.exe(function(err){if(!err){stkIndex=stk;stkIndex[2]=0;var wanConnDev=$.act(ACT_GET,WAN_CONN_DEVICE,stkIndex,null,["WANIPConnectionNumberOfEntries","WANPPPConnectionNumberOfEntries"]);$.exe(function(err){if(!err){if((wanConnDev.WANIPConnectionNumberOfEntries==0)&&(wanConnDev.WANPPPConnectionNumberOfEntries==0)){$.act(ACT_DEL,WAN_CONN_DEVICE,stkIndex,null);$.exe(function(err){if(!err){$.loadMain("wan.htm")}})}else{$.loadMain("wan.htm")}}})}})}else{return false}}function doDisConn(val1,val2){var stk=val2;if(val1==1){$.act(ACT_OP,ACT_OP_DHCP_RELEASE,stk)}else{if(val1==2){$.act(ACT_OP,ACT_OP_PPP_DISCONN,stk)}}$.addLoading($.id("refresh"));if(!$.exe()){$.timeout(function(){$.reload()},1500)}}function doConn(val1,val2){var stk=val2;if(val1==1){$.act(ACT_OP,ACT_OP_DHCP_RENEW,stk)}else{if(val1==2){$.act(ACT_OP,ACT_OP_PPP_CONN,stk)}}$.addLoading($.id("refresh"));if(!$.exe()){$.timeout(function(){$.reload()},1500)}}function init(){if(INCLUDE_IPV6){$.removeClass($.id("t_ipvx"),"nd")}var wanDslInfList=$.act(ACT_GL,WAN_DSL_INTF_CFG,null,null,["status"]);var wanComInfList=$.act(ACT_GL,WAN_COMMON_INTF_CFG,null,null,["WANAccessType"]);var wanDslLnkList=$.act(ACT_GL,WAN_DSL_LINK_CFG,null,null);if(INCLUDE_IPTV){var iptvCfg=$.act(ACT_GET,DSL_IPTV_CFG,null,null,["iptvVPI","iptvVCI"])}var wanIpConList=$.act(ACT_GL,WAN_IP_CONN,null,null);var wanPppConList=$.act(ACT_GL,WAN_PPP_CONN,null,null);var l3Forwarding=$.act(ACT_GET,L3_FORWARDING,null,null,["__ifAliasName"]);if(INCLUDE_IPV6){var l3Ip6Forwarding=$.act(ACT_GET,L3_IP6_FORWARDING,null,null,["__ifAliasName"])}$.exe(function(err){if(!err){$.removeClass($.id("wanList"),"nd");var tbl=$.id("wan_table");var wanDslInfStkList="";var wanDslInfStatusList="";for(var i=0;i<wanDslInfList.length;i++){var stkParts=(wanDslInfList[i].__stack).split(",");wanDslInfStkList+=stkParts[0]+",";wanDslInfStatusList+=wanDslInfList[i].status+","}var wanDslLnkTypeList="";var wanDslLnkStkList="";var wanDslLnkDesaddrList="";for(var i=0;i<wanDslLnkList.length;i++){var stkParts=(wanDslLnkList[i].__stack).split(",");wanDslLnkStkList+=stkParts[0]+stkParts[1]+",";wanDslLnkTypeList+=wanDslLnkList[i].linkType+",";wanDslLnkDesaddrList+=wanDslLnkList[i].destinationAddress+","}$.each(wanComInfList,function(){if(this.WANAccessType=="DSL"){$.wd.pStk=this.__stack;$.wd.l3ForwardingObj.__ifAliasName=l3Forwarding.__ifAliasName;if(INCLUDE_IPV6){$.wd.l3Ip6ForwardingObj.__ifAliasName=l3Ip6Forwarding.__ifAliasName}}});$.each(wanIpConList,function(){var tmpStk=$.stkPop(this.__stack,2);if($.wd.pStk==tmpStk){var row=tbl.insertRow(-1);cell=row.insertCell(-1);cell.innerHTML=this.name;var thisStkParts=(this.__stack).split(",");var stk=thisStkParts[0]+thisStkParts[1];var stkIndex=(wanDslLnkStkList).split(",");var stk1=thisStkParts[0];var stkIndex1=(wanDslInfStkList).split(",");var lnkTypeIndex=(wanDslLnkTypeList).split(",");var desaddrIndex=(wanDslLnkDesaddrList).split(",");var statusIndex=(wanDslInfStatusList).split(",");for(var j=0;j<stkIndex.length;j++){if(stk==stkIndex[j]){connObj={};connObj.dsl=$.act(ACT_GET,WAN_DSL_LINK_CFG,$.stkPop(this.__stack,1),null,["destinationAddress","linkType","ATMPeakCellRate","ATMMaximumBurstSize","ATMSustainableCellRate","ATMEncapsulation","ATMQoS"]);$.exe();connObj.obj=this;connObj.obj.__stack=this.__stack;cell=row.insertCell(-1);if(lnkTypeIndex[j]=="IPoA"){connObj.type="ipoa";cell.innerHTML="IPoA";cell=row.insertCell(-1);cell.innerHTML=desaddrIndex[j].split(":")[1];if(INCLUDE_IPV6){cell=row.insertCell(-1);cell.innerHTML="IPv4"}cell=row.insertCell(-1);cell.innerHTML=(this.externalIPAddress+" /"+(32-($.getmaskbit(this.subnetMask))));cell=row.insertCell(-1);cell.innerHTML=(this.defaultGateway)?this.defaultGateway:"0.0.0.0";cell=row.insertCell(-1);if(this.DNSServers==""){cell.innerHTML="0.0.0.0 0.0.0.0"}else{cell.innerHTML=(this.DNSServers.split(",")[0]+" "+this.DNSServers.split(",")[1])}}if(lnkTypeIndex[j]=="EoA"){if(this.connectionType=="IP_Bridged"){connObj.type="bridge";cell.innerHTML="<span class='T T_bridge'>"+s_str.bridge+"</span>";cell=row.insertCell(-1);cell.innerHTML=desaddrIndex[j].split(":")[1];if(INCLUDE_IPV6){cell=row.insertCell(-1);cell.innerHTML="N/A"}cell=row.insertCell(-1);cell.innerHTML="N/A";cell=row.insertCell(-1);cell.innerHTML="N/A";cell=row.insertCell(-1);cell.innerHTML="N/A"}if(this.connectionType=="IP_Routed"){if(this.addressingType=="DHCP"){connObj.type="dynamicIp";cell.innerHTML="<span class='T T_dynip'>"+s_str.dynip+"</span>";cell=row.insertCell(-1);cell.innerHTML=desaddrIndex[j].split(":")[1];if(INCLUDE_IPV6){cell=row.insertCell(-1);if(this.X_TP_IPv4Enabled==1&&this.X_TP_IPv6Enabled==1){cell.innerHTML="IPv4 IPv6"}else{if(this.X_TP_IPv4Enabled==1){cell.innerHTML="IPv4"}else{if(this.X_TP_IPv6Enabled==1){cell.innerHTML="IPv6"}}}}cell=row.insertCell(-1);cell.innerHTML=(this.externalIPAddress+" /"+(32-($.getmaskbit(this.subnetMask))));cell=row.insertCell(-1);cell.innerHTML=(this.defaultGateway)?this.defaultGateway:"0.0.0.0";cell=row.insertCell(-1);if(this.DNSServers==""){cell.innerHTML="0.0.0.0 0.0.0.0"}else{cell.innerHTML=(this.DNSServers.split(",")[0]+" "+this.DNSServers.split(",")[1])}}else{if(this.addressingType=="Static"){connObj.type="staticIp";cell.innerHTML="<span class='T T_staip'>"+s_str.staip+"</span>";cell=row.insertCell(-1);cell.innerHTML=desaddrIndex[j].split(":")[1];if(INCLUDE_IPV6){cell=row.insertCell(-1);if(this.X_TP_IPv4Enabled==1&&this.X_TP_IPv6Enabled==1){cell.innerHTML="IPv4 IPv6"}else{if(this.X_TP_IPv4Enabled==1){cell.innerHTML="IPv4"}else{if(this.X_TP_IPv6Enabled==1){cell.innerHTML="IPv6"}}}}cell=row.insertCell(-1);cell.innerHTML=(this.externalIPAddress+" /"+(32-($.getmaskbit(this.subnetMask))));cell=row.insertCell(-1);cell.innerHTML=(this.defaultGateway)?this.defaultGateway:"0.0.0.0";cell=row.insertCell(-1);if(this.DNSServers==""){cell.innerHTML="0.0.0.0 0.0.0.0"}else{cell.innerHTML=(this.DNSServers.split(",")[0]+" "+this.DNSServers.split(",")[1])}}}}}$.wd.editIndex=$.wd.conn.push(connObj);break}}var thisStk="["+this.__stack+"]";cell=row.insertCell(-1);for(var j=0;j<stkIndex1.length;j++){if(stk1==stkIndex1[j]){if(statusIndex[j]=="Up"){if(this.connectionStatus=="Connected"){cell.innerHTML="<span class='T T_connected'>"+m_str.connected+"</span>";cell=row.insertCell(-1);if((this.connectionType=="IP_Bridged")||((this.connectionType=="IP_Routed")&&(this.addressingType=="Static"))){cell.innerHTML="<input type='button' class='button M T T_disconn' value='"+m_str.disconn+"' disabled/>"}else{cell.innerHTML="<input type='button' class='button M T T_disconn' value='"+m_str.disconn+"' onClick='doDisConn(1, "+thisStk+");'/>"}}else{if((this.connectionStatus=="Disconnected")||(this.connectionStatus=="Unconfigured")){cell.innerHTML="<span class='T T_disconnected'>"+m_str.disconnected+"</span>";cell=row.insertCell(-1);if(INCLUDE_IPV6&&this.X_TP_IPv4Enabled==0){cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}else{cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' onClick='doConn(1, "+thisStk+");'/>"}}else{$.auto(function(){if(!$.locked()){$.reload()}},5000);cell.innerHTML="<span class='T T_connecting'>"+m_str.connecting+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}}}else{if((statusIndex[j]=="Initializing")||(statusIndex[j]=="EstablishingLink")){$.auto(function(){if(!$.locked()){$.reload()}},5000);cell.innerHTML="DSL <span class='T T_initing'>"+m_str.initing+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}else{cell.innerHTML="DSL <span class='T T_disconnected'>"+m_str.disconnected+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}}cell=row.insertCell(-1);if(this.connectionType=="IP_Bridged"){if(INCLUDE_IPTV){var iptvName="iptv_"+iptvCfg.iptvVPI+"_"+iptvCfg.iptvVCI;if(this.name==iptvName){cell.innerHTML="<span class='a T T_view' onClick='doEdit(1, "+thisStk+")'>"+m_str.view+"</span>"}else{cell.innerHTML="<span class='a T T_view' onClick='doEdit(1, "+thisStk+")'>"+m_str.view+"</span>&nbsp;<span class='a T T_del' onClick='doDel(1, "+thisStk+")'>"+m_str.del+"</span>"}}else{cell.innerHTML="<span class='a T T_view' onClick='doEdit(1, "+thisStk+")'>"+m_str.view+"</span>&nbsp;<span class='a T T_del' onClick='doDel(1, "+thisStk+")'>"+m_str.del+"</span>"}}else{cell.innerHTML="<span class='a T T_edit' onClick='doEdit(1, "+thisStk+")'>"+m_str.edit+"</span>&nbsp;<span class='a T T_del' onClick='doDel(1, "+thisStk+")'>"+m_str.del+"</span>"}break}}}});$.each(wanPppConList,function(){var tmpStk=$.stkPop(this.__stack,2);if($.wd.pStk==tmpStk){var row=tbl.insertRow(-1);cell=row.insertCell(-1);cell.innerHTML=this.name;var thisStkParts=(this.__stack).split(",");var stk=thisStkParts[0]+thisStkParts[1];var stkIndex=(wanDslLnkStkList).split(",");var stk1=thisStkParts[0];var stkIndex1=(wanDslInfStkList).split(",");var lnkTypeIndex=(wanDslLnkTypeList).split(",");var desaddrIndex=(wanDslLnkDesaddrList).split(",");var statusIndex=(wanDslInfStatusList).split(",");connObj={};connObj.dsl=$.act(ACT_GET,WAN_DSL_LINK_CFG,$.stkPop(this.__stack,1),null,["destinationAddress","linkType","ATMPeakCellRate","ATMMaximumBurstSize","ATMSustainableCellRate","ATMEncapsulation","ATMQoS"]);$.exe();connObj.obj=this;connObj.obj.__stack=this.__stack;cell=row.insertCell(-1);if(this.transportType=="PPPoA"){cell.innerHTML="PPPoA";connObj.type="pppoa"}else{if(this.transportType=="PPPoE"){cell.innerHTML="PPPoE";connObj.type="pppoe"}else{if(this.transportType=="L2TP"){cell.innerHTML="L2TP"}else{if(this.transportType=="PPTP"){cell.innerHTML="PPTP"}else{cell.innerHTML="<span class='T T_unknown'>"+m_str.unknown+"</span>"}}}}$.wd.editIndex=$.wd.conn.push(connObj);for(var j=0;j<desaddrIndex.length;j++){if(stkIndex[j]==stk){cell=row.insertCell(-1);var desaddrParts=desaddrIndex[j].split(":");cell.innerHTML=desaddrParts[1]}}if(INCLUDE_IPV6){cell=row.insertCell(-1);if(this.X_TP_IPv4Enabled==1&&this.X_TP_IPv6Enabled==1){cell.innerHTML="IPv4 IPv6"}else{if(this.X_TP_IPv4Enabled==1){cell.innerHTML="IPv4"}else{if(this.X_TP_IPv6Enabled==1){cell.innerHTML="IPv6"}}}}cell=row.insertCell(-1);if((this.externalIPAddress=="")||(this.externalIPAddress=="0.0.0.0")){cell.innerHTML="0.0.0.0/0"}else{cell.innerHTML=(this.externalIPAddress+"/32")}cell=row.insertCell(-1);cell.innerHTML=(this.remoteIPAddress?this.remoteIPAddress:"0.0.0.0");cell=row.insertCell(-1);if(this.DNSServers==""){cell.innerHTML="0.0.0.0 0.0.0.0"}else{cell.innerHTML=(this.DNSServers.split(",")[0]+" "+this.DNSServers.split(",")[1])}var thisStk="["+this.__stack+"]";cell=row.insertCell(-1);for(var j=0;j<stkIndex1.length;j++){if(stk1==stkIndex1[j]){if(statusIndex[j]=="Up"){if(INCLUDE_IPV6&&this.X_TP_IPv4Enabled==0){cell.innerHTML="<span class='T T_disconnected'>"+m_str.disconnected+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}else{if(this.connectionStatus=="Connected"){cell.innerHTML="<span class='T T_connected'>"+m_str.connected+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_disconn' value='"+m_str.disconn+"' onClick='doDisConn(2, "+thisStk+");'/>"}else{if((this.connectionStatus=="Disconnected")||(this.connectionStatus=="Unconfigured")){cell.innerHTML="<span class='T T_disconnected'>"+m_str.disconnected+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' onClick='doConn(2, "+thisStk+");'/>"}else{if(this.connectionStatus=="Connecting"){$.auto(function(){if(!$.locked()){$.reload()}},5000);cell.innerHTML="<span class='T T_connecting'>"+m_str.connecting+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_disconn' value='"+m_str.disconn+"' onClick='doDisConn(2, "+thisStk+");'/>"}}}}}else{if((statusIndex[j]=="Initializing")||(statusIndex[j]=="EstablishingLink")){$.auto(function(){if(!$.locked()){$.reload()}},5000);cell.innerHTML="DSL <span class='T T_initing'>"+m_str.initing+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}else{cell.innerHTML="DSL <span class='T T_disconnected'>"+m_str.disconnected+"</span>";cell=row.insertCell(-1);cell.innerHTML="<input type='button' class='button M T T_conn' value='"+m_str.conn+"' disabled='disabled'/>"}}cell=row.insertCell(-1);cell.innerHTML="<span class='a T T_edit' onClick='doEdit(2, "+thisStk+")'>"+m_str.edit+"</span>&nbsp;<span class='a T T_del' onClick='doDel(2, "+thisStk+")'>"+m_str.del+"</span>";break}}}})}})};</script>
<p class="et T" id="et">ADSL WAN Interface</p>
<div class="con1 XXL" id="wanList">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="L1 T" id="t_info">This page shows the information of the entire ADSL WAN interface.</p>
<p class="br"></p>
<table class="tc bdr XXL" id="wan_table" align="center" cellspacing="0" cellpadding="0"  style="border:1px solid #999">
<tr>
	<th class="T" id="t_name">Name</th>
	<th class="T" id="t_type">Type</th>
	<th>VPI/VCI</th>
	<th class="nd" id="t_ipvx">IPvX</th>
	<th class="T T_ipmask">IP/Mask</th>
	<th class="T T_gateway">Gateway</th>
	<th>DNS</th>
	<th class="T T_status">Status</th>
	<th class="T T_conn">Connect</th>
	<th class="T T_action">Action</th>
</tr>
</table>
</div>
<p class="bl"></p>
<p class="tail">
<input type="button" id="add" class="button L T T_add" value="Add" onclick="doAdd()" />
<input type="button" id="refresh" class="button L T T_refresh" value="Refresh" onclick="$.addLoading(this, 200, function(){$.reload()});" />
</p>
</div>

<script language="javascript" type="text/javascript">var connObj={type:null,obj:{},dsl:{}};$.wd={conn:new Array(),pStk:null,editIndex:0,l3ForwardingObj:{},l3Ip6ForwardingObj:{}};init();</script>